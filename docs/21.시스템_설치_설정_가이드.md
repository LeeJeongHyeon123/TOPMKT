# üîß ÏãúÏä§ÌÖú ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï Í∞ÄÏù¥Îìú

**ÏµúÏ¢Ö ÏàòÏ†ïÏùº:** 2025-12-26 KST  
**Î¨∏ÏÑú Î≤ÑÏ†Ñ:** 1.0  
**Ï†ÅÏö© Î≤îÏúÑ:** ÌÉëÎßàÏºÄÌåÖ Ï†ÑÏ≤¥ ÏãúÏä§ÌÖú ÏÑ§Ïπò

---

## üìã Î™©Ï∞®

1. [ÏãúÏä§ÌÖú ÏöîÍµ¨ÏÇ¨Ìï≠](#1-ÏãúÏä§ÌÖú-ÏöîÍµ¨ÏÇ¨Ìï≠)
2. [ÏÑúÎ≤Ñ ÌôòÍ≤Ω ÏÑ§Ï†ï](#2-ÏÑúÎ≤Ñ-ÌôòÍ≤Ω-ÏÑ§Ï†ï)
3. [PHP ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï](#3-php-ÏÑ§Ïπò-Î∞è-ÏÑ§Ï†ï)
4. [Node.js ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï](#4-nodejs-ÏÑ§Ïπò-Î∞è-ÏÑ§Ï†ï)
5. [Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï](#5-Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§-ÏÑ§Ïπò-Î∞è-ÏÑ§Ï†ï)
6. [Ïõπ ÏÑúÎ≤Ñ ÏÑ§Ï†ï](#6-Ïõπ-ÏÑúÎ≤Ñ-ÏÑ§Ï†ï)
7. [ÌîÑÎ°úÏ†ùÌä∏ Î∞∞Ìè¨](#7-ÌîÑÎ°úÏ†ùÌä∏-Î∞∞Ìè¨)
8. [SSL Ïù∏Ï¶ùÏÑú ÏÑ§Ï†ï](#8-ssl-Ïù∏Ï¶ùÏÑú-ÏÑ§Ï†ï)
9. [Î≥¥Ïïà ÏÑ§Ï†ï](#9-Î≥¥Ïïà-ÏÑ§Ï†ï)
10. [Î™®ÎãàÌÑ∞ÎßÅ ÏÑ§Ï†ï](#10-Î™®ÎãàÌÑ∞ÎßÅ-ÏÑ§Ï†ï)

---

## 1. ÏãúÏä§ÌÖú ÏöîÍµ¨ÏÇ¨Ìï≠

### üñ•Ô∏è ÌïòÎìúÏõ®Ïñ¥ ÏÇ¨Ïñë

#### ÏµúÏÜå ÏöîÍµ¨ÏÇ¨Ìï≠
```
CPU: Intel Core i3 ÎòêÎäî AMD Ryzen 3 (2ÏΩîÏñ¥ Ïù¥ÏÉÅ)
RAM: 4GB Ïù¥ÏÉÅ
Storage: 50GB SSD Ïù¥ÏÉÅ
Network: 100Mbps Ïù¥ÏÉÅ
```

#### Í∂åÏû• ÏÇ¨Ïñë
```
CPU: Intel Core i5 ÎòêÎäî AMD Ryzen 5 (4ÏΩîÏñ¥ Ïù¥ÏÉÅ)
RAM: 8GB Ïù¥ÏÉÅ
Storage: 100GB NVMe SSD Ïù¥ÏÉÅ
Network: 1Gbps Ïù¥ÏÉÅ
```

#### Ïö¥ÏòÅ ÌôòÍ≤Ω Í∂åÏû• ÏÇ¨Ïñë
```
CPU: Intel Xeon ÎòêÎäî AMD EPYC (8ÏΩîÏñ¥ Ïù¥ÏÉÅ)
RAM: 16GB Ïù¥ÏÉÅ
Storage: 200GB NVMe SSD Ïù¥ÏÉÅ (RAID 1 Íµ¨ÏÑ±)
Network: 10Gbps Ïù¥ÏÉÅ
```

### üíª Ïö¥ÏòÅÏ≤¥Ï†ú ÏßÄÏõê

#### ÏßÄÏõê Ïö¥ÏòÅÏ≤¥Ï†ú
- **Ubuntu**: 20.04 LTS, 22.04 LTS (Í∂åÏû•)
- **CentOS**: 8.x, 9.x
- **RHEL**: 8.x, 9.x
- **Debian**: 11.x, 12.x

#### Í∂åÏû• Ïö¥ÏòÅÏ≤¥Ï†ú
```bash
Ubuntu 22.04 LTS Server
- Ïû•Í∏∞ ÏßÄÏõê (2027ÎÖÑÍπåÏßÄ)
- ÌíçÎ∂ÄÌïú Ìå®ÌÇ§ÏßÄ ÏÉùÌÉúÍ≥Ñ
- ÏïàÏ†ïÏ†ÅÏù∏ ÏÑ±Îä•
```

---

## 2. ÏÑúÎ≤Ñ ÌôòÍ≤Ω ÏÑ§Ï†ï

### üîÑ ÏãúÏä§ÌÖú ÏóÖÎç∞Ïù¥Ìä∏

```bash
#!/bin/bash
# update-system.sh

echo "üîÑ ÏãúÏä§ÌÖú ÏóÖÎç∞Ïù¥Ìä∏ ÏãúÏûë..."

# 1. Ìå®ÌÇ§ÏßÄ Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏
apt update

# 2. ÏãúÏä§ÌÖú Ìå®ÌÇ§ÏßÄ ÏóÖÍ∑∏Î†àÏù¥Îìú
apt upgrade -y

# 3. Î∂àÌïÑÏöîÌïú Ìå®ÌÇ§ÏßÄ Ï†úÍ±∞
apt autoremove -y
apt autoclean

# 4. Ïû¨Î∂ÄÌåÖ ÌïÑÏöî Ïó¨Î∂Ä ÌôïÏù∏
if [ -f /var/run/reboot-required ]; then
    echo "‚ö†Ô∏è ÏãúÏä§ÌÖú Ïû¨Î∂ÄÌåÖÏù¥ ÌïÑÏöîÌï©ÎãàÎã§."
    echo "Ïû¨Î∂ÄÌåÖ ÌõÑ ÏÑ§ÏπòÎ•º Í≥ÑÏÜçÌïòÏÑ∏Ïöî: sudo reboot"
    exit 1
fi

echo "‚úÖ ÏãúÏä§ÌÖú ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å!"
```

### üõ†Ô∏è ÌïÑÏàò Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò

```bash
#!/bin/bash
# install-essentials.sh

echo "üì¶ ÌïÑÏàò Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò Ï§ë..."

# 1. Í∏∞Î≥∏ Í∞úÎ∞ú ÎèÑÍµ¨
apt install -y \
    curl \
    wget \
    git \
    unzip \
    vim \
    htop \
    tree \
    build-essential

# 2. Î≥¥Ïïà ÎèÑÍµ¨
apt install -y \
    ufw \
    fail2ban \
    certbot

# 3. ÏãúÏä§ÌÖú Î™®ÎãàÌÑ∞ÎßÅ ÎèÑÍµ¨
apt install -y \
    iotop \
    nethogs \
    ncdu \
    screen \
    tmux

echo "‚úÖ ÌïÑÏàò Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò ÏôÑÎ£å!"
```

### üîí ÏÇ¨Ïö©Ïûê Î∞è Í∂åÌïú ÏÑ§Ï†ï

```bash
#!/bin/bash
# setup-users.sh

# 1. Ïõπ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò ÏÇ¨Ïö©Ïûê ÏÉùÏÑ±
useradd -r -s /bin/false -d /var/www/topmkt topmkt

# 2. Ïõπ ÏÑúÎ≤Ñ Í∑∏Î£πÏóê Ï∂îÍ∞Ä
usermod -a -G www-data topmkt

# 3. SSH ÌÇ§ Í∏∞Î∞ò Ïù∏Ï¶ù ÏÑ§Ï†ï (ÏÑ†ÌÉùÏÇ¨Ìï≠)
# mkdir -p /home/deploy/.ssh
# chmod 700 /home/deploy/.ssh
# echo "your-public-key" > /home/deploy/.ssh/authorized_keys
# chmod 600 /home/deploy/.ssh/authorized_keys

echo "‚úÖ ÏÇ¨Ïö©Ïûê Î∞è Í∂åÌïú ÏÑ§Ï†ï ÏôÑÎ£å!"
```

---

## 3. PHP ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï

### üêò PHP 8.0 ÏÑ§Ïπò

```bash
#!/bin/bash
# install-php.sh

echo "üêò PHP 8.0 ÏÑ§Ïπò ÏãúÏûë..."

# 1. PHP 8.0 Ï†ÄÏû•ÏÜå Ï∂îÍ∞Ä
add-apt-repository ppa:ondrej/php -y
apt update

# 2. PHP 8.0 Î∞è ÌïÑÏàò ÌôïÏû• Î™®Îìà ÏÑ§Ïπò
apt install -y \
    php8.0 \
    php8.0-fpm \
    php8.0-mysql \
    php8.0-mysqli \
    php8.0-curl \
    php8.0-gd \
    php8.0-zip \
    php8.0-xml \
    php8.0-mbstring \
    php8.0-json \
    php8.0-intl \
    php8.0-bcmath \
    php8.0-opcache

# 3. PHP Î≤ÑÏ†Ñ ÌôïÏù∏
php --version
php -m | grep -E "(mysqli|curl|gd|zip)"

echo "‚úÖ PHP 8.0 ÏÑ§Ïπò ÏôÑÎ£å!"
```

### ‚öôÔ∏è PHP ÏÑ§Ï†ï ÏµúÏ†ÅÌôî

```bash
#!/bin/bash
# configure-php.sh

PHP_INI="/etc/php/8.0/fpm/php.ini"
PHP_POOL="/etc/php/8.0/fpm/pool.d/www.conf"

echo "‚öôÔ∏è PHP ÏÑ§Ï†ï ÏµúÏ†ÅÌôî Ï§ë..."

# 1. PHP.ini ÏµúÏ†ÅÌôî
sed -i 's/memory_limit = .*/memory_limit = 256M/' $PHP_INI
sed -i 's/max_execution_time = .*/max_execution_time = 60/' $PHP_INI
sed -i 's/upload_max_filesize = .*/upload_max_filesize = 20M/' $PHP_INI
sed -i 's/post_max_size = .*/post_max_size = 25M/' $PHP_INI
sed -i 's/max_input_vars = .*/max_input_vars = 5000/' $PHP_INI

# 2. OPcache ÏÑ§Ï†ï
echo "" >> $PHP_INI
echo "; OPcache ÏµúÏ†ÅÌôî" >> $PHP_INI
echo "opcache.enable=1" >> $PHP_INI
echo "opcache.memory_consumption=128" >> $PHP_INI
echo "opcache.interned_strings_buffer=8" >> $PHP_INI
echo "opcache.max_accelerated_files=4000" >> $PHP_INI
echo "opcache.revalidate_freq=2" >> $PHP_INI
echo "opcache.fast_shutdown=1" >> $PHP_INI

# 3. PHP-FPM ÌíÄ ÏÑ§Ï†ï
sed -i 's/pm.max_children = .*/pm.max_children = 50/' $PHP_POOL
sed -i 's/pm.start_servers = .*/pm.start_servers = 5/' $PHP_POOL
sed -i 's/pm.min_spare_servers = .*/pm.min_spare_servers = 5/' $PHP_POOL
sed -i 's/pm.max_spare_servers = .*/pm.max_spare_servers = 35/' $PHP_POOL

# 4. PHP-FPM Ïû¨ÏãúÏûë
systemctl restart php8.0-fpm
systemctl enable php8.0-fpm

echo "‚úÖ PHP ÏÑ§Ï†ï ÏµúÏ†ÅÌôî ÏôÑÎ£å!"
```

---

## 4. Node.js ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï

### üü¢ Node.js 20.x ÏÑ§Ïπò

```bash
#!/bin/bash
# install-nodejs.sh

echo "üü¢ Node.js 20.x ÏÑ§Ïπò ÏãúÏûë..."

# 1. NodeSource Ï†ÄÏû•ÏÜå Ï∂îÍ∞Ä
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -

# 2. Node.js ÏÑ§Ïπò
apt install -y nodejs

# 3. Î≤ÑÏ†Ñ ÌôïÏù∏
node --version
npm --version

# 4. npm ÏµúÏã† Î≤ÑÏ†ÑÏúºÎ°ú ÏóÖÎç∞Ïù¥Ìä∏
npm install -g npm@latest

# 5. Ïú†Ïö©Ìïú Ï†ÑÏó≠ Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò
npm install -g \
    pm2 \
    typescript \
    ts-node \
    nodemon

echo "‚úÖ Node.js 20.x ÏÑ§Ïπò ÏôÑÎ£å!"
```

### üì¶ ÌîÑÎ°†Ìä∏ÏóîÎìú ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò

```bash
#!/bin/bash
# install-frontend-deps.sh

echo "üì¶ ÌîÑÎ°†Ìä∏ÏóîÎìú ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò Ï§ë..."

# 1. ÌîÑÎ°†Ìä∏ÏóîÎìú ÎîîÎ†âÌÜ†Î¶¨Î°ú Ïù¥Îèô
cd /var/www/topmkt/frontend/src/frontend

# 2. ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò (ÌîÑÎ°úÎçïÏÖòÎßå)
npm ci --only=production

# 3. ÎπåÎìú ÎèÑÍµ¨ ÏÑ§Ïπò (Í∞úÎ∞ú ÌôòÍ≤ΩÏóêÏÑúÎßå)
if [ "$NODE_ENV" != "production" ]; then
    npm ci
fi

# 4. Í∏ÄÎ°úÎ≤å ÎπåÎìú ÎèÑÍµ¨ ÌôïÏù∏
npm list -g --depth=0

echo "‚úÖ ÌîÑÎ°†Ìä∏ÏóîÎìú ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò ÏôÑÎ£å!"
```

---

## 5. Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï

### üóÑÔ∏è MariaDB 10.6 ÏÑ§Ïπò

```bash
#!/bin/bash
# install-mariadb.sh

echo "üóÑÔ∏è MariaDB 10.6 ÏÑ§Ïπò ÏãúÏûë..."

# 1. MariaDB Ï†ÄÏû•ÏÜå Ï∂îÍ∞Ä
curl -LsS https://downloads.mariadb.com/MariaDB/mariadb_repo_setup | bash

# 2. MariaDB ÏÑ§Ïπò
apt install -y mariadb-server mariadb-client

# 3. MariaDB ÏÑúÎπÑÏä§ ÏãúÏûë
systemctl start mariadb
systemctl enable mariadb

# 4. Î≥¥Ïïà ÏÑ§Ï†ï
mysql_secure_installation

echo "‚úÖ MariaDB 10.6 ÏÑ§Ïπò ÏôÑÎ£å!"
```

### üîß Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÑ§Ï†ï

```bash
#!/bin/bash
# configure-database.sh

echo "üîß Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÑ§Ï†ï Ï§ë..."

# 1. MariaDB ÏµúÏ†ÅÌôî ÏÑ§Ï†ï
cat > /etc/mysql/mariadb.conf.d/99-topmkt.cnf << 'EOF'
[mysqld]
# Í∏∞Î≥∏ ÏÑ§Ï†ï
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci
init-connect = 'SET NAMES utf8mb4'

# ÏÑ±Îä• ÏµúÏ†ÅÌôî
innodb_buffer_pool_size = 512M
innodb_log_file_size = 128M
innodb_flush_log_at_trx_commit = 2
query_cache_size = 64M
query_cache_type = 1
max_connections = 200
key_buffer_size = 256M

# Î°úÍπÖ
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2

[mysql]
default-character-set = utf8mb4

[client]
default-character-set = utf8mb4
EOF

# 2. MariaDB Ïû¨ÏãúÏûë
systemctl restart mariadb

echo "‚úÖ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÑ§Ï†ï ÏôÑÎ£å!"
```

### üèóÔ∏è Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï¥àÍ∏∞Ìôî

```bash
#!/bin/bash
# init-database.sh

echo "üèóÔ∏è Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï¥àÍ∏∞Ìôî Ï§ë..."

# 1. Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ±
mysql -u root -p << 'EOF'
CREATE DATABASE IF NOT EXISTS topmkt 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;

CREATE USER IF NOT EXISTS 'topmkt_user'@'localhost' 
IDENTIFIED BY 'secure_password_here';

GRANT ALL PRIVILEGES ON topmkt.* TO 'topmkt_user'@'localhost';
FLUSH PRIVILEGES;
EOF

# 2. ÌÖåÏù¥Î∏î ÏÉùÏÑ±
cd /var/www/topmkt
php create_tables.php

echo "‚úÖ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å!"
```

---

## 6. Ïõπ ÏÑúÎ≤Ñ ÏÑ§Ï†ï

### üåê Apache 2.4 ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï

```bash
#!/bin/bash
# install-apache.sh

echo "üåê Apache 2.4 ÏÑ§Ïπò ÏãúÏûë..."

# 1. Apache ÏÑ§Ïπò
apt install -y apache2

# 2. ÌïÑÏàò Î™®Îìà ÌôúÏÑ±Ìôî
a2enmod rewrite
a2enmod ssl
a2enmod headers
a2enmod expires
a2enmod deflate
a2enmod proxy
a2enmod proxy_fcgi

# 3. PHP-FPM Ïó∞Îèô ÏÑ§Ï†ï
a2enconf php8.0-fpm

# 4. Apache ÏÑúÎπÑÏä§ ÏãúÏûë
systemctl start apache2
systemctl enable apache2

echo "‚úÖ Apache 2.4 ÏÑ§Ïπò ÏôÑÎ£å!"
```

### ‚öôÔ∏è Virtual Host ÏÑ§Ï†ï

```bash
#!/bin/bash
# configure-vhost.sh

echo "‚öôÔ∏è Virtual Host ÏÑ§Ï†ï Ï§ë..."

# 1. ÏÇ¨Ïù¥Ìä∏ ÏÑ§Ï†ï ÌååÏùº ÏÉùÏÑ±
cat > /etc/apache2/sites-available/topmkt.conf << 'EOF'
<VirtualHost *:80>
    ServerName www.topmktx.com
    ServerAlias topmktx.com
    DocumentRoot /var/www/topmkt/public
    
    # ÎîîÎ†âÌÜ†Î¶¨ ÏÑ§Ï†ï
    <Directory /var/www/topmkt/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # PHP-FPM Ï≤òÎ¶¨
        <FilesMatch \.php$>
            SetHandler "proxy:unix:/var/run/php/php8.0-fpm.sock|fcgi://localhost"
        </FilesMatch>
    </Directory>
    
    # Î°úÍ∑∏ ÏÑ§Ï†ï
    ErrorLog ${APACHE_LOG_DIR}/topmkt_error.log
    CustomLog ${APACHE_LOG_DIR}/topmkt_access.log combined
    
    # Î≥¥Ïïà Ìó§Îçî
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    
    # HTTPÏóêÏÑú HTTPSÎ°ú Î¶¨Îã§Ïù¥Î†âÌä∏
    Redirect permanent / https://www.topmktx.com/
</VirtualHost>

<VirtualHost *:443>
    ServerName www.topmktx.com
    ServerAlias topmktx.com
    DocumentRoot /var/www/topmkt/public
    
    # SSL ÏÑ§Ï†ï (Let's Encrypt ÏÑ§Ïπò ÌõÑ Ï∂îÍ∞ÄÎê®)
    SSLEngine on
    # SSLCertificateFile /etc/letsencrypt/live/www.topmktx.com/fullchain.pem
    # SSLCertificateKeyFile /etc/letsencrypt/live/www.topmktx.com/privkey.pem
    
    # ÎîîÎ†âÌÜ†Î¶¨ ÏÑ§Ï†ï
    <Directory /var/www/topmkt/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # PHP-FPM Ï≤òÎ¶¨
        <FilesMatch \.php$>
            SetHandler "proxy:unix:/var/run/php/php8.0-fpm.sock|fcgi://localhost"
        </FilesMatch>
    </Directory>
    
    # Ï†ïÏ†Å ÌååÏùº Ï∫êÏã±
    <LocationMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg)$">
        ExpiresActive On
        ExpiresDefault "access plus 1 month"
        Header append Cache-Control "public"
    </LocationMatch>
    
    # ÏïïÏ∂ï ÏÑ§Ï†ï
    <Location />
        SetOutputFilter DEFLATE
        SetEnvIfNoCase Request_URI \
            \.(?:gif|jpe?g|png)$ no-gzip dont-vary
        SetEnvIfNoCase Request_URI \
            \.(?:exe|t?gz|zip|bz2|sit|rar)$ no-gzip dont-vary
    </Location>
    
    # Î°úÍ∑∏ ÏÑ§Ï†ï
    ErrorLog ${APACHE_LOG_DIR}/topmkt_ssl_error.log
    CustomLog ${APACHE_LOG_DIR}/topmkt_ssl_access.log combined
    
    # Î≥¥Ïïà Ìó§Îçî
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
</VirtualHost>
EOF

# 2. ÏÇ¨Ïù¥Ìä∏ ÌôúÏÑ±Ìôî
a2ensite topmkt.conf
a2dissite 000-default.conf

# 3. ÏÑ§Ï†ï Í≤ÄÏ¶ù Î∞è Ïû¨ÏãúÏûë
apache2ctl configtest
systemctl restart apache2

echo "‚úÖ Virtual Host ÏÑ§Ï†ï ÏôÑÎ£å!"
```

---

## 7. ÌîÑÎ°úÏ†ùÌä∏ Î∞∞Ìè¨

### üìÅ ÎîîÎ†âÌÜ†Î¶¨ Íµ¨Ï°∞ ÏÉùÏÑ±

```bash
#!/bin/bash
# setup-directories.sh

echo "üìÅ ÌîÑÎ°úÏ†ùÌä∏ ÎîîÎ†âÌÜ†Î¶¨ Íµ¨Ï°∞ ÏÉùÏÑ± Ï§ë..."

# 1. Í∏∞Î≥∏ ÎîîÎ†âÌÜ†Î¶¨ ÏÉùÏÑ±
mkdir -p /var/www/topmkt
mkdir -p /var/www/topmkt/logs
mkdir -p /var/www/topmkt/backup
mkdir -p /var/cache/topmkt
mkdir -p /var/uploads/topmkt

# 2. Í∂åÌïú ÏÑ§Ï†ï
chown -R www-data:www-data /var/www/topmkt
chown -R www-data:www-data /var/cache/topmkt
chown -R www-data:www-data /var/uploads/topmkt

# 3. Í∂åÌïú ÏÑ§Ï†ï
chmod -R 755 /var/www/topmkt
chmod -R 775 /var/www/topmkt/logs
chmod -R 775 /var/cache/topmkt
chmod -R 775 /var/uploads/topmkt

echo "‚úÖ ÎîîÎ†âÌÜ†Î¶¨ Íµ¨Ï°∞ ÏÉùÏÑ± ÏôÑÎ£å!"
```

### üöÄ ÏΩîÎìú Î∞∞Ìè¨

```bash
#!/bin/bash
# deploy-code.sh

echo "üöÄ ÏΩîÎìú Î∞∞Ìè¨ ÏãúÏûë..."

PROJECT_DIR="/var/www/topmkt"
BACKUP_DIR="/var/www/topmkt/backup"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)

# 1. Í∏∞Ï°¥ ÏΩîÎìú Î∞±ÏóÖ (ÏûàÎäî Í≤ΩÏö∞)
if [ -d "$PROJECT_DIR/public" ]; then
    echo "üì¶ Í∏∞Ï°¥ ÏΩîÎìú Î∞±ÏóÖ Ï§ë..."
    tar -czf "$BACKUP_DIR/backup_$TIMESTAMP.tar.gz" -C "$PROJECT_DIR" . 2>/dev/null || true
fi

# 2. GitÏóêÏÑú ÏΩîÎìú Í∞ÄÏ†∏Ïò§Í∏∞ (ÎòêÎäî ÌååÏùº Î≥µÏÇ¨)
# Option A: Git clone
# git clone https://github.com/your-repo/topmkt.git $PROJECT_DIR

# Option B: ÏïïÏ∂ï ÌååÏùº Ìï¥Ï†ú (ÏóÖÎ°úÎìúÎêú Í≤ΩÏö∞)
# cd $PROJECT_DIR && tar -xzf topmkt-source.tar.gz

# 3. ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò
cd $PROJECT_DIR/frontend/src/frontend
npm ci --only=production

# 4. ÌîÑÎ°†Ìä∏ÏóîÎìú ÎπåÎìú
npm run build

# 5. Í∂åÌïú Ïû¨ÏÑ§Ï†ï
chown -R www-data:www-data $PROJECT_DIR
chmod -R 755 $PROJECT_DIR
chmod -R 775 $PROJECT_DIR/logs

# 6. Ï∫êÏãú ÎîîÎ†âÌÜ†Î¶¨ ÏÉùÏÑ±
mkdir -p /var/cache/topmkt
chown -R www-data:www-data /var/cache/topmkt

echo "‚úÖ ÏΩîÎìú Î∞∞Ìè¨ ÏôÑÎ£å!"
```

---

## 8. SSL Ïù∏Ï¶ùÏÑú ÏÑ§Ï†ï

### üîí Let's Encrypt ÏÑ§Ï†ï

```bash
#!/bin/bash
# setup-ssl.sh

echo "üîí SSL Ïù∏Ï¶ùÏÑú ÏÑ§Ï†ï ÏãúÏûë..."

# 1. Certbot ÏÑ§Ïπò (Ïù¥ÎØ∏ ÏÑ§ÏπòÎê®)
apt install -y python3-certbot-apache

# 2. SSL Ïù∏Ï¶ùÏÑú Î∞úÍ∏â
certbot --apache -d www.topmktx.com -d topmktx.com

# 3. ÏûêÎèô Í∞±Ïã† ÏÑ§Ï†ï
echo "0 12 * * * /usr/bin/certbot renew --quiet" | crontab -

# 4. Apache Ïû¨ÏãúÏûë
systemctl restart apache2

# 5. SSL ÏÑ§Ï†ï ÌôïÏù∏
echo "üîç SSL ÏÑ§Ï†ï ÌôïÏù∏..."
curl -I https://www.topmktx.com | head -n 5

echo "‚úÖ SSL Ïù∏Ï¶ùÏÑú ÏÑ§Ï†ï ÏôÑÎ£å!"
```

---

## 9. Î≥¥Ïïà ÏÑ§Ï†ï

### üõ°Ô∏è Î∞©ÌôîÎ≤Ω ÏÑ§Ï†ï

```bash
#!/bin/bash
# setup-firewall.sh

echo "üõ°Ô∏è Î∞©ÌôîÎ≤Ω ÏÑ§Ï†ï Ï§ë..."

# 1. UFW Ï¥àÍ∏∞Ìôî
ufw --force reset

# 2. Í∏∞Î≥∏ Ï†ïÏ±Ö ÏÑ§Ï†ï
ufw default deny incoming
ufw default allow outgoing

# 3. SSH ÌóàÏö© (Ìè¨Ìä∏ Î≥ÄÍ≤Ω Í∂åÏû•)
ufw allow 22/tcp
# ufw allow 2222/tcp  # SSH Ìè¨Ìä∏ Î≥ÄÍ≤Ω Ïãú

# 4. HTTP/HTTPS ÌóàÏö©
ufw allow 80/tcp
ufw allow 443/tcp

# 5. MySQL (Î°úÏª¨Îßå)
# ufw allow from 127.0.0.1 to any port 3306

# 6. UFW ÌôúÏÑ±Ìôî
ufw --force enable

# 7. ÏÉÅÌÉú ÌôïÏù∏
ufw status verbose

echo "‚úÖ Î∞©ÌôîÎ≤Ω ÏÑ§Ï†ï ÏôÑÎ£å!"
```

### üîê Fail2Ban ÏÑ§Ï†ï

```bash
#!/bin/bash
# setup-fail2ban.sh

echo "üîê Fail2Ban ÏÑ§Ï†ï Ï§ë..."

# 1. SSH Î≥¥Ìò∏ ÏÑ§Ï†ï
cat > /etc/fail2ban/jail.local << 'EOF'
[DEFAULT]
bantime = 3600
findtime = 600
maxretry = 3

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3

[apache-auth]
enabled = true
port = http,https
filter = apache-auth
logpath = /var/log/apache2/*error.log
maxretry = 3

[apache-badbots]
enabled = true
port = http,https
filter = apache-badbots
logpath = /var/log/apache2/*access.log
maxretry = 3
EOF

# 2. Fail2Ban Ïû¨ÏãúÏûë
systemctl restart fail2ban
systemctl enable fail2ban

# 3. ÏÉÅÌÉú ÌôïÏù∏
fail2ban-client status

echo "‚úÖ Fail2Ban ÏÑ§Ï†ï ÏôÑÎ£å!"
```

---

## 10. Î™®ÎãàÌÑ∞ÎßÅ ÏÑ§Ï†ï

### üìä Î°úÍ∑∏ Î°úÌÖåÏù¥ÏÖò ÏÑ§Ï†ï

```bash
#!/bin/bash
# setup-logrotate.sh

echo "üìä Î°úÍ∑∏ Î°úÌÖåÏù¥ÏÖò ÏÑ§Ï†ï Ï§ë..."

# 1. Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Î°úÍ∑∏ Î°úÌÖåÏù¥ÏÖò
cat > /etc/logrotate.d/topmkt << 'EOF'
/var/www/topmkt/logs/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 www-data www-data
    postrotate
        systemctl reload apache2
    endscript
}
EOF

# 2. MySQL Ïä¨Î°úÏö∞ ÏøºÎ¶¨ Î°úÍ∑∏ Î°úÌÖåÏù¥ÏÖò
cat > /etc/logrotate.d/mysql-slow << 'EOF'
/var/log/mysql/slow.log {
    daily
    missingok
    rotate 7
    compress
    delaycompress
    notifempty
    create 644 mysql mysql
    postrotate
        systemctl reload mysql
    endscript
}
EOF

echo "‚úÖ Î°úÍ∑∏ Î°úÌÖåÏù¥ÏÖò ÏÑ§Ï†ï ÏôÑÎ£å!"
```

### üîç ÏãúÏä§ÌÖú Î™®ÎãàÌÑ∞ÎßÅ Ïä§ÌÅ¨Î¶ΩÌä∏

```bash
#!/bin/bash
# system-monitor.sh

cat > /usr/local/bin/system-monitor.sh << 'EOF'
#!/bin/bash

# ÏãúÏä§ÌÖú ÏÉÅÌÉú Ï≤¥ÌÅ¨ Ïä§ÌÅ¨Î¶ΩÌä∏
LOG_FILE="/var/log/system-monitor.log"
DATE=$(date '+%Y-%m-%d %H:%M:%S')

# 1. ÏÑúÎπÑÏä§ ÏÉÅÌÉú ÌôïÏù∏
check_service() {
    local service=$1
    if systemctl is-active --quiet $service; then
        echo "[$DATE] ‚úÖ $service is running" >> $LOG_FILE
    else
        echo "[$DATE] ‚ùå $service is not running" >> $LOG_FILE
        systemctl restart $service
    fi
}

# 2. ÎîîÏä§ÌÅ¨ ÏÇ¨Ïö©Îüâ ÌôïÏù∏
DISK_USAGE=$(df / | tail -1 | awk '{print $5}' | sed 's/%//')
if [ $DISK_USAGE -gt 80 ]; then
    echo "[$DATE] ‚ö†Ô∏è Disk usage is high: ${DISK_USAGE}%" >> $LOG_FILE
fi

# 3. Î©îÎ™®Î¶¨ ÏÇ¨Ïö©Îüâ ÌôïÏù∏
MEM_USAGE=$(free | grep Mem | awk '{printf("%.0f", $3/$2 * 100.0)}')
if [ $MEM_USAGE -gt 85 ]; then
    echo "[$DATE] ‚ö†Ô∏è Memory usage is high: ${MEM_USAGE}%" >> $LOG_FILE
fi

# 4. ÏÑúÎπÑÏä§ ÏÉÅÌÉú ÌôïÏù∏
check_service apache2
check_service mysql
check_service php8.0-fpm

# 5. ÏõπÏÇ¨Ïù¥Ìä∏ ÏùëÎãµ ÌôïÏù∏
if ! curl -s --max-time 10 https://www.topmktx.com > /dev/null; then
    echo "[$DATE] ‚ùå Website is not responding" >> $LOG_FILE
fi
EOF

chmod +x /usr/local/bin/system-monitor.sh

# 3. ÌÅ¨Î°† ÏûëÏóÖ ÏÑ§Ï†ï
echo "*/5 * * * * /usr/local/bin/system-monitor.sh" | crontab -

echo "‚úÖ ÏãúÏä§ÌÖú Î™®ÎãàÌÑ∞ÎßÅ ÏÑ§Ï†ï ÏôÑÎ£å!"
```

---

## üéØ ÏÑ§Ïπò ÏôÑÎ£å Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏

### ‚úÖ ÏãúÏä§ÌÖú Í∏∞Î≥∏ ÏÑ§Ï†ï
- [ ] Ïö¥ÏòÅÏ≤¥Ï†ú ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å
- [ ] ÌïÑÏàò Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò ÏôÑÎ£å
- [ ] ÏÇ¨Ïö©Ïûê Î∞è Í∂åÌïú ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] Î∞©ÌôîÎ≤Ω ÏÑ§Ï†ï ÏôÑÎ£å

### ‚úÖ ÏÜåÌîÑÌä∏Ïõ®Ïñ¥ Ïä§ÌÉù
- [ ] PHP 8.0 ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] Node.js 20.x ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] MariaDB 10.6 ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] Apache 2.4 ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï ÏôÑÎ£å

### ‚úÖ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Î∞∞Ìè¨
- [ ] ÌîÑÎ°úÏ†ùÌä∏ ÏΩîÎìú Î∞∞Ìè¨ ÏôÑÎ£å
- [ ] Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å
- [ ] ÌîÑÎ°†Ìä∏ÏóîÎìú ÎπåÎìú ÏôÑÎ£å
- [ ] Virtual Host ÏÑ§Ï†ï ÏôÑÎ£å

### ‚úÖ Î≥¥Ïïà Î∞è SSL
- [ ] SSL Ïù∏Ï¶ùÏÑú ÏÑ§Ïπò ÏôÑÎ£å
- [ ] HTTPS Î¶¨Îã§Ïù¥Î†âÌä∏ ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] Fail2Ban ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] Î≥¥Ïïà Ìó§Îçî ÏÑ§Ï†ï ÏôÑÎ£å

### ‚úÖ Î™®ÎãàÌÑ∞ÎßÅ Î∞è Î∞±ÏóÖ
- [ ] Î°úÍ∑∏ Î°úÌÖåÏù¥ÏÖò ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] ÏãúÏä§ÌÖú Î™®ÎãàÌÑ∞ÎßÅ ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] ÏûêÎèô Î∞±ÏóÖ ÏÑ§Ï†ï ÏôÑÎ£å
- [ ] ÏÑ±Îä• Î™®ÎãàÌÑ∞ÎßÅ ÌôúÏÑ±Ìôî

---

## üö® Î¨∏Ï†ú Ìï¥Í≤∞

### ÏùºÎ∞òÏ†ÅÏù∏ ÏÑ§Ïπò Î¨∏Ï†ú

#### 1. PHP ÌôïÏû• Î™®Îìà Ïò§Î•ò
```bash
# ÌôïÏû• Î™®Îìà Ïû¨ÏÑ§Ïπò
apt install --reinstall php8.0-mysql php8.0-curl php8.0-gd php8.0-zip

# Î™®Îìà ÌôïÏù∏
php -m | grep -E "(mysqli|curl|gd|zip)"
```

#### 2. Apache Í∂åÌïú Î¨∏Ï†ú
```bash
# Í∂åÌïú Ïû¨ÏÑ§Ï†ï
chown -R www-data:www-data /var/www/topmkt
chmod -R 755 /var/www/topmkt
```

#### 3. Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ïó∞Í≤∞ Ïò§Î•ò
```bash
# MySQL ÏÉÅÌÉú ÌôïÏù∏
systemctl status mysql

# ÏÇ¨Ïö©Ïûê Í∂åÌïú ÌôïÏù∏
mysql -u root -p -e "SHOW GRANTS FOR 'topmkt_user'@'localhost';"
```

#### 4. SSL Ïù∏Ï¶ùÏÑú Î¨∏Ï†ú
```bash
# Certbot Î°úÍ∑∏ ÌôïÏù∏
cat /var/log/letsencrypt/letsencrypt.log

# ÏàòÎèô Í∞±Ïã† ÏãúÎèÑ
certbot renew --dry-run
```

---

## üìû ÏßÄÏõê Î∞è Î¨∏Ïùò

### üÜò Í∏¥Í∏â ÏßÄÏõê
- **Í∏∞Ïà† ÏßÄÏõê**: dev@topmktx.com
- **ÏÑúÎ≤Ñ Ïû•Ïï†**: 24ÏãúÍ∞Ñ ÎåÄÍ∏∞
- **Î≥¥Ïïà Ïù¥Ïäà**: security@topmktx.com

### üìö Í¥ÄÎ†® Î¨∏ÏÑú
- [Î∞∞Ìè¨ Î∞è Ïö¥ÏòÅ Í∞ÄÏù¥Îìú](14.Î∞∞Ìè¨_Ïö¥ÏòÅ_Í∞ÄÏù¥Îìú.md)
- [Î≥¥Ïïà Í∞ÄÏù¥Îìú](17.Î≥¥Ïïà_Í∞ÄÏù¥Îìú.md)
- [ÏÑ±Îä• ÏµúÏ†ÅÌôî Í∞ÄÏù¥Îìú](15.ÏÑ±Îä•_ÏµúÏ†ÅÌôî_Í∞ÄÏù¥Îìú.md)

---

*üìù Î¨∏ÏÑú ÏûëÏÑ±Ïûê: ÏãúÏä§ÌÖú Í¥ÄÎ¶¨ÌåÄ*  
*üìß Î¨∏Ïùò: sysadmin@topmktx.com*  
*üîÑ ÏóÖÎç∞Ïù¥Ìä∏: Ï£ºÏöî ÏãúÏä§ÌÖú Î≥ÄÍ≤Ω Ïãú*