# ğŸ§ª í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

**ìµœì¢… ìˆ˜ì •ì¼:** 2025-12-26 KST  
**ë¬¸ì„œ ë²„ì „:** 1.0  
**ì ìš© ë²”ìœ„:** íƒ‘ë§ˆì¼€íŒ… ì „ì²´ í”„ë¡œì íŠ¸ (React + PHP)

---

## ğŸ“‹ ëª©ì°¨

1. [í…ŒìŠ¤íŠ¸ ì „ëµ ê°œìš”](#1-í…ŒìŠ¤íŠ¸-ì „ëµ-ê°œìš”)
2. [React ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸](#2-react-ì»´í¬ë„ŒíŠ¸-í…ŒìŠ¤íŠ¸)
3. [API ë° ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸](#3-api-ë°-ì„œë¹„ìŠ¤-í…ŒìŠ¤íŠ¸)
4. [PHP ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸](#4-php-ë°±ì—”ë“œ-í…ŒìŠ¤íŠ¸)
5. [E2E í…ŒìŠ¤íŠ¸](#5-e2e-í…ŒìŠ¤íŠ¸)
6. [í…ŒìŠ¤íŠ¸ ìë™í™”](#6-í…ŒìŠ¤íŠ¸-ìë™í™”)
7. [ì„±ëŠ¥ í…ŒìŠ¤íŠ¸](#7-ì„±ëŠ¥-í…ŒìŠ¤íŠ¸)
8. [í…ŒìŠ¤íŠ¸ ëª¨ë²” ì‚¬ë¡€](#8-í…ŒìŠ¤íŠ¸-ëª¨ë²”-ì‚¬ë¡€)

---

## 1. í…ŒìŠ¤íŠ¸ ì „ëµ ê°œìš”

### ğŸ—ï¸ í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ

```
     E2E í…ŒìŠ¤íŠ¸ (10%)
        /\
       /  \
    í†µí•© í…ŒìŠ¤íŠ¸ (20%)
      /      \
     /        \
  ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (70%)
```

### ğŸ“Š í…ŒìŠ¤íŠ¸ ë²”ìœ„

| í…ŒìŠ¤íŠ¸ ìœ í˜• | ë„êµ¬ | ë²”ìœ„ | ì‹¤í–‰ ì‹œì  |
|------------|-----|-----|----------|
| **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸** | Vitest + Testing Library | ì»´í¬ë„ŒíŠ¸, í•¨ìˆ˜, í›… | ê°œë°œ ì¤‘ + CI/CD |
| **í†µí•© í…ŒìŠ¤íŠ¸** | Vitest + MSW | API ì—°ë™, ì„œë¹„ìŠ¤ ë ˆì´ì–´ | CI/CD |
| **E2E í…ŒìŠ¤íŠ¸** | Playwright | ì „ì²´ ì‚¬ìš©ì í”Œë¡œìš° | ë°°í¬ ì „ |
| **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸** | Lighthouse CI | í˜ì´ì§€ ë¡œë“œ, ë Œë”ë§ | ë°°í¬ ì „ |

### ğŸ¯ í…ŒìŠ¤íŠ¸ ëª©í‘œ

- **í’ˆì§ˆ ë³´ì¦**: ê¸°ëŠ¥ ì •í™•ì„± ê²€ì¦
- **íšŒê·€ ë°©ì§€**: ê¸°ì¡´ ê¸°ëŠ¥ ë³´í˜¸
- **ê°œë°œ ì†ë„**: ë¹ ë¥¸ í”¼ë“œë°± ë£¨í”„
- **ë¬¸ì„œí™”**: ì½”ë“œ ë™ì‘ ëª…ì„¸

---

## 2. React ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸

### ğŸ› ï¸ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •

```bash
# í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ ë„êµ¬ ì„¤ì¹˜
npm install -D vitest @testing-library/react @testing-library/jest-dom
npm install -D @testing-library/user-event msw
```

```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: ['./src/test/setup.ts'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      exclude: [
        'node_modules/',
        'src/test/',
        '**/*.d.ts',
        '**/*.config.*'
      ]
    }
  }
});
```

```typescript
// src/test/setup.ts
import '@testing-library/jest-dom';
import { beforeAll, afterEach, afterAll } from 'vitest';
import { server } from './mocks/server';

// MSW ì„œë²„ ì„¤ì •
beforeAll(() => server.listen());
afterEach(() => server.resetHandlers());
afterAll(() => server.close());
```

### ğŸ§© ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ íŒ¨í„´

```typescript
// Button.test.tsx
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { describe, it, expect, vi } from 'vitest';
import Button from './Button';

describe('Button ì»´í¬ë„ŒíŠ¸', () => {
  // 1. ë Œë”ë§ í…ŒìŠ¤íŠ¸
  it('ê¸°ë³¸ ë Œë”ë§ì´ ì •ìƒ ì‘ë™í•œë‹¤', () => {
    render(<Button>í´ë¦­í•˜ì„¸ìš”</Button>);
    
    const button = screen.getByRole('button', { name: 'í´ë¦­í•˜ì„¸ìš”' });
    expect(button).toBeInTheDocument();
    expect(button).toHaveClass('btn-primary');
  });

  // 2. Props í…ŒìŠ¤íŠ¸
  it('variant propì„ ì˜¬ë°”ë¥´ê²Œ ì ìš©í•œë‹¤', () => {
    const { rerender } = render(<Button variant="secondary">ë²„íŠ¼</Button>);
    
    expect(screen.getByRole('button')).toHaveClass('btn-secondary');
    
    rerender(<Button variant="outline">ë²„íŠ¼</Button>);
    expect(screen.getByRole('button')).toHaveClass('btn-outline');
  });

  // 3. ìƒí˜¸ì‘ìš© í…ŒìŠ¤íŠ¸
  it('í´ë¦­ ì´ë²¤íŠ¸ê°€ ì •ìƒ ì‘ë™í•œë‹¤', async () => {
    const user = userEvent.setup();
    const handleClick = vi.fn();
    
    render(<Button onClick={handleClick}>í´ë¦­</Button>);
    
    const button = screen.getByRole('button');
    await user.click(button);
    
    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  // 4. ìƒíƒœ í…ŒìŠ¤íŠ¸
  it('ë¡œë”© ìƒíƒœë¥¼ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œí•œë‹¤', () => {
    render(<Button loading>ì €ì¥</Button>);
    
    const button = screen.getByRole('button');
    expect(button).toBeDisabled();
    expect(screen.getByText('ë¡œë”© ì¤‘...')).toBeInTheDocument();
    expect(screen.getByTestId('loading-spinner')).toBeInTheDocument();
  });

  // 5. ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸
  it('ì ‘ê·¼ì„± ì†ì„±ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ëœë‹¤', () => {
    render(
      <Button 
        disabled 
        aria-label="ì‚­ì œ ë²„íŠ¼"
        aria-describedby="delete-help"
      >
        ì‚­ì œ
      </Button>
    );
    
    const button = screen.getByRole('button');
    expect(button).toHaveAttribute('aria-label', 'ì‚­ì œ ë²„íŠ¼');
    expect(button).toHaveAttribute('aria-describedby', 'delete-help');
    expect(button).toBeDisabled();
  });
});
```

### ğŸª ì»¤ìŠ¤í…€ í›… í…ŒìŠ¤íŠ¸

```typescript
// useAuth.test.ts
import { renderHook, act } from '@testing-library/react';
import { describe, it, expect, vi, beforeEach } from 'vitest';
import { useAuth } from './useAuth';
import { AuthProvider } from '../context/AuthContext';

// í…ŒìŠ¤íŠ¸ ë˜í¼
const wrapper = ({ children }: { children: React.ReactNode }) => (
  <AuthProvider>{children}</AuthProvider>
);

describe('useAuth í›…', () => {
  beforeEach(() => {
    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í´ë¦¬ì–´
    localStorage.clear();
    vi.clearAllMocks();
  });

  it('ì´ˆê¸° ìƒíƒœê°€ ì˜¬ë°”ë¥´ë‹¤', () => {
    const { result } = renderHook(() => useAuth(), { wrapper });
    
    expect(result.current.user).toBeNull();
    expect(result.current.isAuthenticated).toBe(false);
    expect(result.current.isLoading).toBe(false);
  });

  it('ë¡œê·¸ì¸ì´ ì„±ê³µì ìœ¼ë¡œ ì‘ë™í•œë‹¤', async () => {
    const { result } = renderHook(() => useAuth(), { wrapper });
    
    const credentials = {
      email: 'test@example.com',
      password: 'password123'
    };
    
    await act(async () => {
      await result.current.login(credentials);
    });
    
    expect(result.current.isAuthenticated).toBe(true);
    expect(result.current.user).toEqual(
      expect.objectContaining({
        email: 'test@example.com'
      })
    );
  });

  it('ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•œë‹¤', async () => {
    const { result } = renderHook(() => useAuth(), { wrapper });
    
    const invalidCredentials = {
      email: 'wrong@example.com',
      password: 'wrongpassword'
    };
    
    await expect(async () => {
      await act(async () => {
        await result.current.login(invalidCredentials);
      });
    }).rejects.toThrow('ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
    
    expect(result.current.isAuthenticated).toBe(false);
  });
});
```

### ğŸ”„ Context í…ŒìŠ¤íŠ¸

```typescript
// AuthContext.test.tsx
import { render, screen, act } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { describe, it, expect } from 'vitest';
import { AuthProvider, useAuth } from './AuthContext';

// í…ŒìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸
const TestComponent = () => {
  const { user, isAuthenticated, login, logout } = useAuth();
  
  return (
    <div>
      <div data-testid="auth-status">
        {isAuthenticated ? `ë¡œê·¸ì¸ë¨: ${user?.email}` : 'ë¡œê·¸ì•„ì›ƒ'}
      </div>
      <button onClick={() => login({ email: 'test@example.com', password: 'password' })}>
        ë¡œê·¸ì¸
      </button>
      <button onClick={logout}>ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  );
};

describe('AuthContext', () => {
  it('ì¸ì¦ ìƒíƒœë¥¼ ì˜¬ë°”ë¥´ê²Œ ê´€ë¦¬í•œë‹¤', async () => {
    const user = userEvent.setup();
    
    render(
      <AuthProvider>
        <TestComponent />
      </AuthProvider>
    );
    
    // ì´ˆê¸° ìƒíƒœ í™•ì¸
    expect(screen.getByTestId('auth-status')).toHaveTextContent('ë¡œê·¸ì•„ì›ƒ');
    
    // ë¡œê·¸ì¸
    await user.click(screen.getByText('ë¡œê·¸ì¸'));
    
    await act(async () => {
      // ë¡œê·¸ì¸ ì™„ë£Œ ëŒ€ê¸°
    });
    
    expect(screen.getByTestId('auth-status')).toHaveTextContent('ë¡œê·¸ì¸ë¨: test@example.com');
    
    // ë¡œê·¸ì•„ì›ƒ
    await user.click(screen.getByText('ë¡œê·¸ì•„ì›ƒ'));
    
    expect(screen.getByTestId('auth-status')).toHaveTextContent('ë¡œê·¸ì•„ì›ƒ');
  });
});
```

---

## 3. API ë° ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸

### ğŸŒ MSWë¥¼ í™œìš©í•œ API ëª¨í‚¹

```typescript
// src/test/mocks/handlers.ts
import { http, HttpResponse } from 'msw';

export const handlers = [
  // ë¡œê·¸ì¸ API
  http.post('/api/auth/login', async ({ request }) => {
    const body = await request.json() as { email: string; password: string };
    
    if (body.email === 'test@example.com' && body.password === 'password') {
      return HttpResponse.json({
        success: true,
        data: {
          user: {
            id: 1,
            email: 'test@example.com',
            nickname: 'í…ŒìŠ¤íŠ¸ì‚¬ìš©ì',
            role: 'ROLE_USER'
          },
          token: 'mock-jwt-token'
        }
      });
    }
    
    return HttpResponse.json(
      { success: false, message: 'ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' },
      { status: 401 }
    );
  }),

  // ì‚¬ìš©ì ëª©ë¡ API
  http.get('/api/users', () => {
    return HttpResponse.json({
      success: true,
      data: [
        {
          id: 1,
          email: 'user1@example.com',
          nickname: 'ì‚¬ìš©ì1',
          role: 'ROLE_USER'
        },
        {
          id: 2,
          email: 'user2@example.com',
          nickname: 'ì‚¬ìš©ì2',
          role: 'ROLE_CORP'
        }
      ]
    });
  }),

  // ì—ëŸ¬ ì‹œë®¬ë ˆì´ì…˜
  http.get('/api/error', () => {
    return HttpResponse.json(
      { success: false, message: 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' },
      { status: 500 }
    );
  })
];
```

```typescript
// src/test/mocks/server.ts
import { setupServer } from 'msw/node';
import { handlers } from './handlers';

export const server = setupServer(...handlers);
```

### ğŸ”Œ ì„œë¹„ìŠ¤ ë ˆì´ì–´ í…ŒìŠ¤íŠ¸

```typescript
// authService.test.ts
import { describe, it, expect, beforeEach } from 'vitest';
import { authService } from './authService';

describe('AuthService', () => {
  beforeEach(() => {
    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í´ë¦¬ì–´
    localStorage.clear();
  });

  it('ë¡œê·¸ì¸ì´ ì„±ê³µì ìœ¼ë¡œ ì‘ë™í•œë‹¤', async () => {
    const credentials = {
      email: 'test@example.com',
      password: 'password'
    };
    
    const result = await authService.login(credentials);
    
    expect(result.success).toBe(true);
    expect(result.data.user.email).toBe('test@example.com');
    expect(result.data.token).toBeTruthy();
    
    // í† í°ì´ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ë˜ëŠ”ì§€ í™•ì¸
    expect(localStorage.getItem('auth_token')).toBe('mock-jwt-token');
  });

  it('ì˜ëª»ëœ ì¸ì¦ ì •ë³´ë¡œ ë¡œê·¸ì¸ ì‹œ ì—ëŸ¬ë¥¼ ë°˜í™˜í•œë‹¤', async () => {
    const credentials = {
      email: 'wrong@example.com',
      password: 'wrongpassword'
    };
    
    await expect(authService.login(credentials)).rejects.toThrow('ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
  });

  it('ë¡œê·¸ì•„ì›ƒì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•œë‹¤', () => {
    // í† í° ì„¤ì •
    localStorage.setItem('auth_token', 'test-token');
    
    authService.logout();
    
    expect(localStorage.getItem('auth_token')).toBeNull();
  });

  it('í† í° ê°±ì‹ ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•œë‹¤', async () => {
    // ê¸°ì¡´ í† í° ì„¤ì •
    localStorage.setItem('auth_token', 'old-token');
    
    const newToken = await authService.refreshToken();
    
    expect(newToken).toBeTruthy();
    expect(localStorage.getItem('auth_token')).toBe(newToken);
  });
});
```

---

## 4. PHP ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸

### ğŸ˜ PHPUnit ì„¤ì •

```xml
<!-- phpunit.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="https://schema.phpunit.de/10.0/phpunit.xsd"
         bootstrap="tests/bootstrap.php"
         colors="true"
         testdox="true">
    <testsuites>
        <testsuite name="Unit">
            <directory>tests/Unit</directory>
        </testsuite>
        <testsuite name="Integration">
            <directory>tests/Integration</directory>
        </testsuite>
    </testsuites>
    
    <source>
        <include>
            <directory>src</directory>
        </include>
        <exclude>
            <directory>src/views</directory>
        </exclude>
    </source>
    
    <logging>
        <junit outputFile="tests/results/junit.xml"/>
        <teamcity outputFile="tests/results/teamcity.txt"/>
    </logging>
</phpunit>
```

### ğŸ§ª ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸

```php
<?php
// tests/Unit/Controllers/AuthControllerTest.php

use PHPUnit\Framework\TestCase;
use PHPUnit\Framework\MockObject\MockObject;

class AuthControllerTest extends TestCase
{
    private AuthController $controller;
    private MockObject $userService;
    private MockObject $jwtHelper;
    
    protected function setUp(): void
    {
        $this->userService = $this->createMock(UserService::class);
        $this->jwtHelper = $this->createMock(JWTHelper::class);
        $this->controller = new AuthController($this->userService, $this->jwtHelper);
    }
    
    public function testLoginSuccess(): void
    {
        // Given
        $credentials = [
            'email' => 'test@example.com',
            'password' => 'password123'
        ];
        
        $user = [
            'id' => 1,
            'email' => 'test@example.com',
            'nickname' => 'í…ŒìŠ¤íŠ¸ì‚¬ìš©ì',
            'role' => 'ROLE_USER'
        ];
        
        $token = 'mock-jwt-token';
        
        // When
        $this->userService
            ->expects($this->once())
            ->method('authenticateUser')
            ->with($credentials['email'], $credentials['password'])
            ->willReturn($user);
            
        $this->jwtHelper
            ->expects($this->once())
            ->method('generateToken')
            ->with($user)
            ->willReturn($token);
        
        // Then
        $result = $this->controller->login($credentials);
        
        $this->assertTrue($result['success']);
        $this->assertEquals($user, $result['data']['user']);
        $this->assertEquals($token, $result['data']['token']);
    }
    
    public function testLoginFailure(): void
    {
        // Given
        $credentials = [
            'email' => 'wrong@example.com',
            'password' => 'wrongpassword'
        ];
        
        // When
        $this->userService
            ->expects($this->once())
            ->method('authenticateUser')
            ->with($credentials['email'], $credentials['password'])
            ->willThrowException(new InvalidCredentialsException('ì¸ì¦ ì‹¤íŒ¨'));
        
        // Then
        $this->expectException(InvalidCredentialsException::class);
        $this->controller->login($credentials);
    }
}
```

### ğŸ—„ï¸ ëª¨ë¸ í…ŒìŠ¤íŠ¸

```php
<?php
// tests/Unit/Models/UserTest.php

use PHPUnit\Framework\TestCase;

class UserTest extends TestCase
{
    private User $user;
    
    protected function setUp(): void
    {
        $this->user = new User();
    }
    
    public function testUserValidation(): void
    {
        // Valid user data
        $validData = [
            'nickname' => 'í…ŒìŠ¤íŠ¸ì‚¬ìš©ì',
            'email' => 'test@example.com',
            'phone' => '010-1234-5678',
            'password' => 'SecurePass123!'
        ];
        
        $this->assertTrue($this->user->validate($validData));
        
        // Invalid email
        $invalidEmailData = array_merge($validData, ['email' => 'invalid-email']);
        $this->assertFalse($this->user->validate($invalidEmailData));
        
        // Invalid phone
        $invalidPhoneData = array_merge($validData, ['phone' => '123-456']);
        $this->assertFalse($this->user->validate($invalidPhoneData));
    }
    
    public function testPasswordHashing(): void
    {
        $password = 'password123';
        $hashedPassword = $this->user->hashPassword($password);
        
        $this->assertNotEquals($password, $hashedPassword);
        $this->assertTrue(password_verify($password, $hashedPassword));
    }
    
    public function testUserRoles(): void
    {
        $this->user->setRole('ROLE_USER');
        $this->assertTrue($this->user->hasRole('ROLE_USER'));
        $this->assertFalse($this->user->hasRole('ROLE_ADMIN'));
        
        $this->user->setRole('ROLE_ADMIN');
        $this->assertTrue($this->user->hasRole('ROLE_ADMIN'));
        $this->assertTrue($this->user->hasRole('ROLE_USER')); // ìƒìœ„ ê¶Œí•œ í¬í•¨
    }
}
```

### ğŸ”— í†µí•© í…ŒìŠ¤íŠ¸

```php
<?php
// tests/Integration/AuthIntegrationTest.php

use PHPUnit\Framework\TestCase;

class AuthIntegrationTest extends TestCase
{
    private PDO $pdo;
    
    protected function setUp(): void
    {
        // í…ŒìŠ¤íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
        $this->pdo = new PDO(
            'mysql:host=localhost;dbname=topmkt_test',
            $_ENV['DB_TEST_USER'],
            $_ENV['DB_TEST_PASS']
        );
        
        // íŠ¸ëœì­ì…˜ ì‹œì‘ (í…ŒìŠ¤íŠ¸ í›„ ë¡¤ë°±)
        $this->pdo->beginTransaction();
    }
    
    protected function tearDown(): void
    {
        $this->pdo->rollback();
    }
    
    public function testCompleteAuthFlow(): void
    {
        // 1. íšŒì›ê°€ì…
        $userData = [
            'nickname' => 'í†µí•©í…ŒìŠ¤íŠ¸ì‚¬ìš©ì',
            'email' => 'integration@test.com',
            'phone' => '010-9999-9999',
            'password' => 'TestPass123!'
        ];
        
        $authController = new AuthController();
        $signupResult = $authController->signup($userData);
        
        $this->assertTrue($signupResult['success']);
        $this->assertArrayHasKey('user_id', $signupResult['data']);
        
        // 2. ë¡œê·¸ì¸
        $loginResult = $authController->login([
            'email' => $userData['email'],
            'password' => $userData['password']
        ]);
        
        $this->assertTrue($loginResult['success']);
        $this->assertArrayHasKey('token', $loginResult['data']);
        
        // 3. í† í° ê²€ì¦
        $token = $loginResult['data']['token'];
        $verifyResult = $authController->verifyToken($token);
        
        $this->assertTrue($verifyResult['success']);
        $this->assertEquals($userData['email'], $verifyResult['data']['user']['email']);
    }
}
```

---

## 5. E2E í…ŒìŠ¤íŠ¸

### ğŸ­ Playwright ì„¤ì •

```bash
# Playwright ì„¤ì¹˜
npm install -D @playwright/test
npx playwright install
```

```typescript
// playwright.config.ts
import { defineConfig, devices } from '@playwright/test';

export default defineConfig({
  testDir: './e2e',
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  reporter: 'html',
  
  use: {
    baseURL: 'http://localhost:3000',
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
    video: 'retain-on-failure'
  },

  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] }
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] }
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] }
    },
    {
      name: 'Mobile Chrome',
      use: { ...devices['Pixel 5'] }
    }
  ],

  webServer: {
    command: 'npm run dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI
  }
});
```

### ğŸŒŠ ì‚¬ìš©ì í”Œë¡œìš° í…ŒìŠ¤íŠ¸

```typescript
// e2e/auth.spec.ts
import { test, expect } from '@playwright/test';

test.describe('ì¸ì¦ í”Œë¡œìš°', () => {
  test('íšŒì›ê°€ì…ë¶€í„° ë¡œê·¸ì¸ê¹Œì§€ ì „ì²´ í”Œë¡œìš°', async ({ page }) => {
    // 1. í™ˆí˜ì´ì§€ ì ‘ì†
    await page.goto('/');
    await expect(page).toHaveTitle(/íƒ‘ë§ˆì¼€íŒ…/);
    
    // 2. íšŒì›ê°€ì… í˜ì´ì§€ë¡œ ì´ë™
    await page.click('text=íšŒì›ê°€ì…');
    await expect(page).toHaveURL('/signup');
    
    // 3. íšŒì›ê°€ì… í¼ ì‘ì„±
    const timestamp = Date.now();
    const testEmail = `test${timestamp}@example.com`;
    
    await page.fill('input[name="nickname"]', `í…ŒìŠ¤íŠ¸${timestamp}`);
    await page.fill('input[name="email"]', testEmail);
    await page.fill('input[name="phone"]', '010-1234-5678');
    await page.fill('input[name="password"]', 'TestPass123!');
    await page.fill('input[name="confirmPassword"]', 'TestPass123!');
    
    // 4. ì´ìš©ì•½ê´€ ë™ì˜
    await page.check('input[name="termsAgreed"]');
    await page.check('input[name="privacyAgreed"]');
    
    // 5. íšŒì›ê°€ì… ì œì¶œ
    await page.click('button[type="submit"]');
    
    // 6. ì„±ê³µ ë©”ì‹œì§€ í™•ì¸
    await expect(page.locator('.toast-success')).toBeVisible();
    await expect(page.locator('.toast-success')).toContainText('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤');
    
    // 7. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
    await page.goto('/login');
    
    // 8. ë¡œê·¸ì¸ í¼ ì‘ì„±
    await page.fill('input[name="email"]', testEmail);
    await page.fill('input[name="password"]', 'TestPass123!');
    
    // 9. ë¡œê·¸ì¸ ì œì¶œ
    await page.click('button[type="submit"]');
    
    // 10. ë¡œê·¸ì¸ ì„±ê³µ í™•ì¸
    await expect(page).toHaveURL('/');
    await expect(page.locator('[data-testid="user-menu"]')).toBeVisible();
    await expect(page.locator('.toast-success')).toContainText('ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤');
  });

  test('ë¡œê·¸ì¸ ì‹¤íŒ¨ ì²˜ë¦¬', async ({ page }) => {
    await page.goto('/login');
    
    await page.fill('input[name="email"]', 'wrong@example.com');
    await page.fill('input[name="password"]', 'wrongpassword');
    
    await page.click('button[type="submit"]');
    
    await expect(page.locator('.toast-error')).toBeVisible();
    await expect(page.locator('.toast-error')).toContainText('ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
    await expect(page).toHaveURL('/login');
  });
});
```

### ğŸ“± ë°˜ì‘í˜• í…ŒìŠ¤íŠ¸

```typescript
// e2e/responsive.spec.ts
import { test, expect, devices } from '@playwright/test';

const mobileDevice = devices['iPhone 12'];
const tabletDevice = devices['iPad'];

test.describe('ë°˜ì‘í˜• ë””ìì¸', () => {
  test('ëª¨ë°”ì¼ì—ì„œ ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´', async ({ browser }) => {
    const context = await browser.newContext({
      ...mobileDevice
    });
    const page = await context.newPage();
    
    await page.goto('/');
    
    // ëª¨ë°”ì¼ ë©”ë‰´ ë²„íŠ¼ í™•ì¸
    const menuButton = page.locator('[data-testid="mobile-menu-button"]');
    await expect(menuButton).toBeVisible();
    
    // ë©”ë‰´ ì—´ê¸°
    await menuButton.click();
    const mobileMenu = page.locator('[data-testid="mobile-menu"]');
    await expect(mobileMenu).toBeVisible();
    
    // ë©”ë‰´ í•­ëª© í™•ì¸
    await expect(mobileMenu.locator('text=ì»¤ë®¤ë‹ˆí‹°')).toBeVisible();
    await expect(mobileMenu.locator('text=ê°•ì˜')).toBeVisible();
    await expect(mobileMenu.locator('text=ì´ë²¤íŠ¸')).toBeVisible();
    
    await context.close();
  });

  test('íƒœë¸”ë¦¿ì—ì„œ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ', async ({ browser }) => {
    const context = await browser.newContext({
      ...tabletDevice
    });
    const page = await context.newPage();
    
    await page.goto('/community');
    
    // íƒœë¸”ë¦¿ì—ì„œ 2ì—´ ê·¸ë¦¬ë“œ í™•ì¸
    const posts = page.locator('[data-testid="post-card"]');
    await expect(posts.first()).toBeVisible();
    
    // ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ í™•ì¸
    const firstPost = posts.first();
    const secondPost = posts.nth(1);
    
    const firstPostBox = await firstPost.boundingBox();
    const secondPostBox = await secondPost.boundingBox();
    
    if (firstPostBox && secondPostBox) {
      // ê°™ì€ í–‰ì— ìˆëŠ”ì§€ í™•ì¸ (Y ì¢Œí‘œê°€ ë¹„ìŠ·í•¨)
      expect(Math.abs(firstPostBox.y - secondPostBox.y)).toBeLessThan(50);
    }
    
    await context.close();
  });
});
```

---

## 6. í…ŒìŠ¤íŠ¸ ìë™í™”

### ğŸ”„ GitHub Actions ì„¤ì •

```yaml
# .github/workflows/test.yml
name: í…ŒìŠ¤íŠ¸ ìë™í™”

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  frontend-tests:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Node.js ì„¤ì •
      uses: actions/setup-node@v4
      with:
        node-version: '20.19.0'
        cache: 'npm'
    
    - name: ì˜ì¡´ì„± ì„¤ì¹˜
      run: npm ci
      working-directory: ./frontend/src/frontend
    
    - name: íƒ€ì… ì²´í¬
      run: npm run type-check
      working-directory: ./frontend/src/frontend
    
    - name: ë¦°íŒ…
      run: npm run lint
      working-directory: ./frontend/src/frontend
    
    - name: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
      run: npm run test:coverage
      working-directory: ./frontend/src/frontend
    
    - name: í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì—…ë¡œë“œ
      uses: codecov/codecov-action@v3
      with:
        files: ./frontend/src/frontend/coverage/lcov.info
        flags: frontend
        name: frontend-coverage

  backend-tests:
    runs-on: ubuntu-latest
    
    services:
      mysql:
        image: mysql:8.0
        env:
          MYSQL_ROOT_PASSWORD: test_password
          MYSQL_DATABASE: topmkt_test
        options: >-
          --health-cmd="mysqladmin ping"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=3
        ports:
          - 3306:3306
    
    steps:
    - uses: actions/checkout@v4
    
    - name: PHP ì„¤ì •
      uses: shivammathur/setup-php@v2
      with:
        php-version: '8.0'
        extensions: mysqli, curl, gd, zip
        coverage: xdebug
    
    - name: Composer ì˜ì¡´ì„± ì„¤ì¹˜
      run: composer install --prefer-dist --no-progress --no-suggest
    
    - name: í…ŒìŠ¤íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
      run: |
        mysql -h 127.0.0.1 -u root -ptest_password -e "CREATE DATABASE IF NOT EXISTS topmkt_test;"
        php -f database/init_test.php
    
    - name: PHPUnit í…ŒìŠ¤íŠ¸
      run: vendor/bin/phpunit --coverage-clover=coverage.xml
    
    - name: í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì—…ë¡œë“œ
      uses: codecov/codecov-action@v3
      with:
        files: ./coverage.xml
        flags: backend
        name: backend-coverage

  e2e-tests:
    runs-on: ubuntu-latest
    needs: [frontend-tests, backend-tests]
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Node.js ì„¤ì •
      uses: actions/setup-node@v4
      with:
        node-version: '20.19.0'
        cache: 'npm'
    
    - name: ì˜ì¡´ì„± ì„¤ì¹˜
      run: npm ci
      working-directory: ./frontend/src/frontend
    
    - name: Playwright ì„¤ì¹˜
      run: npx playwright install --with-deps
      working-directory: ./frontend/src/frontend
    
    - name: ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ
      run: npm run build
      working-directory: ./frontend/src/frontend
    
    - name: E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰
      run: npx playwright test
      working-directory: ./frontend/src/frontend
    
    - name: í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì—…ë¡œë“œ
      uses: actions/upload-artifact@v4
      if: failure()
      with:
        name: playwright-report
        path: frontend/src/frontend/playwright-report/
        retention-days: 30
```

### ğŸ“Š í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ì„¤ì •

```typescript
// vitest.config.ts
export default defineConfig({
  test: {
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html', 'lcov'],
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80
        }
      },
      exclude: [
        'node_modules/',
        'src/test/',
        '**/*.d.ts',
        '**/*.config.*',
        '**/types/**',
        '**/*.stories.*'
      ]
    }
  }
});
```

---

## 7. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

### âš¡ Lighthouse CI ì„¤ì •

```json
{
  "ci": {
    "collect": {
      "url": [
        "http://localhost:3000/",
        "http://localhost:3000/login",
        "http://localhost:3000/community",
        "http://localhost:3000/lectures"
      ],
      "numberOfRuns": 3
    },
    "assert": {
      "assertions": {
        "categories:performance": ["warn", {"minScore": 0.8}],
        "categories:accessibility": ["error", {"minScore": 0.9}],
        "categories:best-practices": ["warn", {"minScore": 0.8}],
        "categories:seo": ["error", {"minScore": 0.9}]
      }
    },
    "upload": {
      "target": "temporary-public-storage"
    }
  }
}
```

### ğŸ“ˆ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

```typescript
// e2e/performance.spec.ts
import { test, expect } from '@playwright/test';

test.describe('ì„±ëŠ¥ í…ŒìŠ¤íŠ¸', () => {
  test('í™ˆí˜ì´ì§€ ë¡œë”© ì„±ëŠ¥', async ({ page }) => {
    const startTime = Date.now();
    
    await page.goto('/');
    
    // First Contentful Paint ëŒ€ê¸°
    await page.waitForLoadState('networkidle');
    
    const loadTime = Date.now() - startTime;
    
    // 2ì´ˆ ì´ë‚´ ë¡œë”© ëª©í‘œ
    expect(loadTime).toBeLessThan(2000);
    
    // Core Web Vitals ì¸¡ì •
    const cwv = await page.evaluate(() => {
      return new Promise((resolve) => {
        new PerformanceObserver((list) => {
          const entries = list.getEntries();
          const cwvEntries = entries.filter(entry => 
            ['LCP', 'FID', 'CLS'].includes(entry.name)
          );
          if (cwvEntries.length > 0) {
            resolve(cwvEntries);
          }
        }).observe({entryTypes: ['measure']});
      });
    });
    
    console.log('Core Web Vitals:', cwv);
  });

  test('ëŒ€ìš©ëŸ‰ ë°ì´í„° ë Œë”ë§ ì„±ëŠ¥', async ({ page }) => {
    await page.goto('/community');
    
    // ìŠ¤í¬ë¡¤ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
    const scrollStart = Date.now();
    
    for (let i = 0; i < 10; i++) {
      await page.evaluate(() => {
        window.scrollBy(0, window.innerHeight);
      });
      await page.waitForTimeout(100);
    }
    
    const scrollTime = Date.now() - scrollStart;
    
    // ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ í™•ì¸ (1ì´ˆ ì´ë‚´)
    expect(scrollTime).toBeLessThan(1000);
  });
});
```

---

## 8. í…ŒìŠ¤íŠ¸ ëª¨ë²” ì‚¬ë¡€

### âœ… í…ŒìŠ¤íŠ¸ ì‘ì„± ì›ì¹™

#### 1. **AAA íŒ¨í„´ (Arrange-Act-Assert)**
```typescript
test('ì‚¬ìš©ì ìƒì„±ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•œë‹¤', async () => {
  // Arrange: í…ŒìŠ¤íŠ¸ ì¤€ë¹„
  const userData = {
    nickname: 'í…ŒìŠ¤íŠ¸ì‚¬ìš©ì',
    email: 'test@example.com',
    password: 'password123'
  };
  
  // Act: ì‹¤ì œ ë™ì‘
  const result = await userService.createUser(userData);
  
  // Assert: ê²°ê³¼ ê²€ì¦
  expect(result.success).toBe(true);
  expect(result.data.email).toBe(userData.email);
});
```

#### 2. **ëª…í™•í•œ í…ŒìŠ¤íŠ¸ ì´ë¦„**
```typescript
// âœ… ì¢‹ì€ ì˜ˆ
test('ë¡œê·¸ì¸ ì‹œë„ ì‹œ ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ë©´ 401 ì—ëŸ¬ë¥¼ ë°˜í™˜í•œë‹¤')
test('ë¹ˆ ì´ë©”ì¼ë¡œ íšŒì›ê°€ì… ì‹œë„ ì‹œ ê²€ì¦ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤')

// âŒ ë‚˜ìœ ì˜ˆ
test('ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸')
test('ì‚¬ìš©ì í…ŒìŠ¤íŠ¸')
```

#### 3. **í…ŒìŠ¤íŠ¸ ê²©ë¦¬**
```typescript
// âœ… ê° í…ŒìŠ¤íŠ¸ê°€ ë…ë¦½ì 
describe('UserService', () => {
  beforeEach(() => {
    // ê° í…ŒìŠ¤íŠ¸ ì „ì— ì´ˆê¸°í™”
    database.clearUsers();
    cache.clear();
  });
  
  test('ì‚¬ìš©ì ìƒì„±', () => {
    // ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸
  });
  
  test('ì‚¬ìš©ì ì¡°íšŒ', () => {
    // ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
  });
});
```

### ğŸ¯ í…ŒìŠ¤íŠ¸ ì‘ì„± ì²´í¬ë¦¬ìŠ¤íŠ¸

#### **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**
- [ ] í•¨ìˆ˜/ë©”ì„œë“œì˜ ëª¨ë“  ê²½ë¡œë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ”ê°€?
- [ ] ê²½ê³„ê°’ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ”ê°€?
- [ ] ì—ëŸ¬ ìƒí™©ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ”ê°€?
- [ ] Mockì„ ì ì ˆíˆ ì‚¬ìš©í•˜ëŠ”ê°€?

#### **í†µí•© í…ŒìŠ¤íŠ¸**
- [ ] ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™í•˜ëŠ”ê°€?
- [ ] API ê³„ì•½ì„ ê²€ì¦í•˜ëŠ”ê°€?
- [ ] ì—ëŸ¬ ì²˜ë¦¬ê°€ ì ì ˆí•œê°€?
- [ ] íŠ¸ëœì­ì…˜ì´ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬ë˜ëŠ”ê°€?

#### **E2E í…ŒìŠ¤íŠ¸**
- [ ] ì‹¤ì œ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë°˜ì˜í•˜ëŠ”ê°€?
- [ ] í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ í”Œë¡œìš°ë¥¼ ì»¤ë²„í•˜ëŠ”ê°€?
- [ ] í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì € í˜¸í™˜ì„±ì„ í™•ì¸í•˜ëŠ”ê°€?
- [ ] ëª¨ë°”ì¼ í™˜ê²½ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ”ê°€?

### ğŸ“ í…ŒìŠ¤íŠ¸ í’ˆì§ˆ ì§€í‘œ

| ì§€í‘œ | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|------|----------|
| **ì½”ë“œ ì»¤ë²„ë¦¬ì§€** | 80% ì´ìƒ | Vitest/PHPUnit ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸ |
| **í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œê°„** | 5ë¶„ ì´ë‚´ | CI/CD íŒŒì´í”„ë¼ì¸ ë¡œê·¸ |
| **í”Œë ˆì´í¬ í…ŒìŠ¤íŠ¸** | 1% ë¯¸ë§Œ | ì—°ì† ì‹¤í–‰ ê²°ê³¼ ë¶„ì„ |
| **í…ŒìŠ¤íŠ¸ ê°€ë…ì„±** | ë¦¬ë·° í†µê³¼ | ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸ |

---

## ğŸš€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ëª…ë ¹ì–´

### ğŸ”§ ë¡œì»¬ ê°œë°œ í™˜ê²½

```bash
# í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸
cd frontend/src/frontend

# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm run test

# ì»¤ë²„ë¦¬ì§€ í¬í•¨ í…ŒìŠ¤íŠ¸
npm run test:coverage

# íŠ¹ì • íŒŒì¼ í…ŒìŠ¤íŠ¸
npm run test Button.test.tsx

# ì›Œì¹˜ ëª¨ë“œ
npm run test:watch

# E2E í…ŒìŠ¤íŠ¸
npm run test:e2e

# ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
npm run test:lighthouse
```

```bash
# ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸
cd /workspace

# PHPUnit í…ŒìŠ¤íŠ¸
vendor/bin/phpunit

# ì»¤ë²„ë¦¬ì§€ í¬í•¨
vendor/bin/phpunit --coverage-html coverage

# íŠ¹ì • í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤
vendor/bin/phpunit tests/Unit/AuthControllerTest.php

# í†µí•© í…ŒìŠ¤íŠ¸ë§Œ
vendor/bin/phpunit tests/Integration
```

---

*ğŸ“ ë¬¸ì„œ ì‘ì„±ì: ê°œë°œíŒ€*  
*ğŸ“§ ë¬¸ì˜: dev@topmktx.com*  
*ğŸ”„ ì—…ë°ì´íŠ¸: í…ŒìŠ¤íŠ¸ ì „ëµ ë³€ê²½ ì‹œ*