# GitHub Actions CI/CD 파이프라인 가이드

**최종 수정일:** 2025-06-01 19:30:00 KST

## 목차
1. [개요](#개요)
2. [워크플로우 파일 구조](#워크플로우-파일-구조)
3. [주요 기능](#주요-기능)
4. [사용 방법](#사용-방법)
5. [추가 구성 방법](#추가-구성-방법)

---

## 개요

탑마케팅 프로젝트는 GitHub Actions를 활용하여 CI/CD(지속적 통합/지속적 배포) 파이프라인을 구성합니다. 이 파이프라인은 코드 품질 확인, 테스트 자동화, 그리고 배포 자동화를 지원합니다.

---

## 워크플로우 파일 구조

워크플로우 파일은 `.github/workflows/ci.yml`에 위치하며 다음과 같은 주요 부분으로 구성됩니다:

1. **트리거 조건**: master 브랜치 푸시, PR, 수동 실행
2. **테스트 작업**: PHP 설정, 의존성 설치, 린팅, 테스트 실행
3. **배포 작업**: 테스트 통과 후 릴리즈 커밋 시 자동 태깅 및 푸시

```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
  workflow_dispatch:

jobs:
  test:
    # 테스트 작업 설정...
  
  deploy:
    # 배포 작업 설정...
```

---

## 주요 기능

### 1. 자동 테스트 및 린팅
- PHP 7.4 환경에서 코드 테스트
- Composer 의존성 설치
- 코드 린팅 검사

### 2. 자동 버전 태깅
- "Release X.Y.Z" 형식의 커밋 메시지 감지
- 자동으로 vX.Y.Z 태그 생성 및 푸시
- 예: "Release 1.2.3" 커밋 시 "v1.2.3" 태그 생성

---

## 사용 방법

### 릴리즈 버전 태그 자동화
릴리즈 버전을 태그하려면 다음과 같은 형식으로 커밋 메시지를 작성합니다:

```bash
git commit -m "Release 1.2.3"
git push origin master
```

GitHub Actions가 자동으로 "v1.2.3" 태그를 생성하고 푸시합니다.

### 수동 워크플로우 실행
1. GitHub 저장소 페이지 접속
2. "Actions" 탭 클릭
3. "CI/CD Pipeline" 워크플로우 선택
4. "Run workflow" 버튼 클릭

---

## 추가 구성 방법

### Staging/Production 분리 배포 설정
프로덕션과 스테이징 환경을 분리하여 배포하려면 워크플로우 파일을 다음과 같이 수정합니다:

```yaml
# .github/workflows/ci.yml 파일에 추가

deploy-staging:
  needs: test
  if: github.ref == 'refs/heads/develop'
  runs-on: ubuntu-latest
  steps:
    # 스테이징 환경 배포 스텝

deploy-production:
  needs: test
  if: github.ref == 'refs/heads/master'
  runs-on: ubuntu-latest
  steps:
    # 프로덕션 환경 배포 스텝
```

### 배포 알림 설정
Slack, 이메일 등으로 배포 알림을 받고 싶은 경우:

```yaml
# 배포 작업 마지막에 추가
- name: Send notification
  uses: rtCamp/action-slack-notify@v2
  env:
    SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
    SLACK_TITLE: "배포 완료"
    SLACK_MESSAGE: "버전 ${{ github.event.head_commit.message }} 배포 완료"
```

---

**참고**: 위 설정은 GitHub 저장소가 연결되어 있어야 작동합니다. GitHub 저장소 설정 시 이 워크플로우 파일이 자동으로 인식되어 실행됩니다. 