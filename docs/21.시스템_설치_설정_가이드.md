# ğŸ”§ ì‹œìŠ¤í…œ ì„¤ì¹˜ ë° ì„¤ì • ê°€ì´ë“œ

**ìµœì¢… ìˆ˜ì •ì¼:** 2025-12-26 KST  
**ë¬¸ì„œ ë²„ì „:** 1.0  
**ì ìš© ë²”ìœ„:** íƒ‘ë§ˆì¼€íŒ… ì „ì²´ ì‹œìŠ¤í…œ ì„¤ì¹˜

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­](#1-ì‹œìŠ¤í…œ-ìš”êµ¬ì‚¬í•­)
2. [ì„œë²„ í™˜ê²½ ì„¤ì •](#2-ì„œë²„-í™˜ê²½-ì„¤ì •)
3. [PHP ì„¤ì¹˜ ë° ì„¤ì •](#3-php-ì„¤ì¹˜-ë°-ì„¤ì •)
4. [Node.js ì„¤ì¹˜ ë° ì„¤ì •](#4-nodejs-ì„¤ì¹˜-ë°-ì„¤ì •)
5. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì¹˜ ë° ì„¤ì •](#5-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ì¹˜-ë°-ì„¤ì •)
6. [ì›¹ ì„œë²„ ì„¤ì •](#6-ì›¹-ì„œë²„-ì„¤ì •)
7. [í”„ë¡œì íŠ¸ ë°°í¬](#7-í”„ë¡œì íŠ¸-ë°°í¬)
8. [SSL ì¸ì¦ì„œ ì„¤ì •](#8-ssl-ì¸ì¦ì„œ-ì„¤ì •)
9. [ë³´ì•ˆ ì„¤ì •](#9-ë³´ì•ˆ-ì„¤ì •)
10. [ëª¨ë‹ˆí„°ë§ ì„¤ì •](#10-ëª¨ë‹ˆí„°ë§-ì„¤ì •)

---

## 1. ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

### ğŸ–¥ï¸ í•˜ë“œì›¨ì–´ ì‚¬ì–‘

#### ìµœì†Œ ìš”êµ¬ì‚¬í•­
```
CPU: Intel Core i3 ë˜ëŠ” AMD Ryzen 3 (2ì½”ì–´ ì´ìƒ)
RAM: 4GB ì´ìƒ
Storage: 50GB SSD ì´ìƒ
Network: 100Mbps ì´ìƒ
```

#### ê¶Œì¥ ì‚¬ì–‘
```
CPU: Intel Core i5 ë˜ëŠ” AMD Ryzen 5 (4ì½”ì–´ ì´ìƒ)
RAM: 8GB ì´ìƒ
Storage: 100GB NVMe SSD ì´ìƒ
Network: 1Gbps ì´ìƒ
```

#### ìš´ì˜ í™˜ê²½ ê¶Œì¥ ì‚¬ì–‘
```
CPU: Intel Xeon ë˜ëŠ” AMD EPYC (8ì½”ì–´ ì´ìƒ)
RAM: 16GB ì´ìƒ
Storage: 200GB NVMe SSD ì´ìƒ (RAID 1 êµ¬ì„±)
Network: 10Gbps ì´ìƒ
```

### ğŸ’» ìš´ì˜ì²´ì œ ì§€ì›

#### ì§€ì› ìš´ì˜ì²´ì œ
- **Ubuntu**: 20.04 LTS, 22.04 LTS (ê¶Œì¥)
- **CentOS**: 8.x, 9.x
- **RHEL**: 8.x, 9.x
- **Debian**: 11.x, 12.x

#### ê¶Œì¥ ìš´ì˜ì²´ì œ
```bash
Ubuntu 22.04 LTS Server
- ì¥ê¸° ì§€ì› (2027ë…„ê¹Œì§€)
- í’ë¶€í•œ íŒ¨í‚¤ì§€ ìƒíƒœê³„
- ì•ˆì •ì ì¸ ì„±ëŠ¥
```

---

## 2. ì„œë²„ í™˜ê²½ ì„¤ì •

### ğŸ”„ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸

```bash
#!/bin/bash
# update-system.sh

echo "ğŸ”„ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì‹œì‘..."

# 1. íŒ¨í‚¤ì§€ ëª©ë¡ ì—…ë°ì´íŠ¸
apt update

# 2. ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì—…ê·¸ë ˆì´ë“œ
apt upgrade -y

# 3. ë¶ˆí•„ìš”í•œ íŒ¨í‚¤ì§€ ì œê±°
apt autoremove -y
apt autoclean

# 4. ì¬ë¶€íŒ… í•„ìš” ì—¬ë¶€ í™•ì¸
if [ -f /var/run/reboot-required ]; then
    echo "âš ï¸ ì‹œìŠ¤í…œ ì¬ë¶€íŒ…ì´ í•„ìš”í•©ë‹ˆë‹¤."
    echo "ì¬ë¶€íŒ… í›„ ì„¤ì¹˜ë¥¼ ê³„ì†í•˜ì„¸ìš”: sudo reboot"
    exit 1
fi

echo "âœ… ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì™„ë£Œ!"
```

### ğŸ› ï¸ í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
#!/bin/bash
# install-essentials.sh

echo "ğŸ“¦ í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì¤‘..."

# 1. ê¸°ë³¸ ê°œë°œ ë„êµ¬
apt install -y \
    curl \
    wget \
    git \
    unzip \
    vim \
    htop \
    tree \
    build-essential

# 2. ë³´ì•ˆ ë„êµ¬
apt install -y \
    ufw \
    fail2ban \
    certbot

# 3. ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§ ë„êµ¬
apt install -y \
    iotop \
    nethogs \
    ncdu \
    screen \
    tmux

echo "âœ… í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ!"
```

### ğŸ”’ ì‚¬ìš©ì ë° ê¶Œí•œ ì„¤ì •

```bash
#!/bin/bash
# setup-users.sh

# 1. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ìš©ì ìƒì„±
useradd -r -s /bin/false -d /var/www/topmkt topmkt

# 2. ì›¹ ì„œë²„ ê·¸ë£¹ì— ì¶”ê°€
usermod -a -G www-data topmkt

# 3. SSH í‚¤ ê¸°ë°˜ ì¸ì¦ ì„¤ì • (ì„ íƒì‚¬í•­)
# mkdir -p /home/deploy/.ssh
# chmod 700 /home/deploy/.ssh
# echo "your-public-key" > /home/deploy/.ssh/authorized_keys
# chmod 600 /home/deploy/.ssh/authorized_keys

echo "âœ… ì‚¬ìš©ì ë° ê¶Œí•œ ì„¤ì • ì™„ë£Œ!"
```

---

## 3. PHP ì„¤ì¹˜ ë° ì„¤ì •

### ğŸ˜ PHP 8.0 ì„¤ì¹˜

```bash
#!/bin/bash
# install-php.sh

echo "ğŸ˜ PHP 8.0 ì„¤ì¹˜ ì‹œì‘..."

# 1. PHP 8.0 ì €ì¥ì†Œ ì¶”ê°€
add-apt-repository ppa:ondrej/php -y
apt update

# 2. PHP 8.0 ë° í•„ìˆ˜ í™•ì¥ ëª¨ë“ˆ ì„¤ì¹˜
apt install -y \
    php8.0 \
    php8.0-fpm \
    php8.0-mysql \
    php8.0-mysqli \
    php8.0-curl \
    php8.0-gd \
    php8.0-zip \
    php8.0-xml \
    php8.0-mbstring \
    php8.0-json \
    php8.0-intl \
    php8.0-bcmath \
    php8.0-opcache

# 3. PHP ë²„ì „ í™•ì¸
php --version
php -m | grep -E "(mysqli|curl|gd|zip)"

echo "âœ… PHP 8.0 ì„¤ì¹˜ ì™„ë£Œ!"
```

### âš™ï¸ PHP ì„¤ì • ìµœì í™”

```bash
#!/bin/bash
# configure-php.sh

PHP_INI="/etc/php/8.0/fpm/php.ini"
PHP_POOL="/etc/php/8.0/fpm/pool.d/www.conf"

echo "âš™ï¸ PHP ì„¤ì • ìµœì í™” ì¤‘..."

# 1. PHP.ini ìµœì í™”
sed -i 's/memory_limit = .*/memory_limit = 256M/' $PHP_INI
sed -i 's/max_execution_time = .*/max_execution_time = 60/' $PHP_INI
sed -i 's/upload_max_filesize = .*/upload_max_filesize = 20M/' $PHP_INI
sed -i 's/post_max_size = .*/post_max_size = 25M/' $PHP_INI
sed -i 's/max_input_vars = .*/max_input_vars = 5000/' $PHP_INI

# 2. OPcache ì„¤ì •
echo "" >> $PHP_INI
echo "; OPcache ìµœì í™”" >> $PHP_INI
echo "opcache.enable=1" >> $PHP_INI
echo "opcache.memory_consumption=128" >> $PHP_INI
echo "opcache.interned_strings_buffer=8" >> $PHP_INI
echo "opcache.max_accelerated_files=4000" >> $PHP_INI
echo "opcache.revalidate_freq=2" >> $PHP_INI
echo "opcache.fast_shutdown=1" >> $PHP_INI

# 3. PHP-FPM í’€ ì„¤ì •
sed -i 's/pm.max_children = .*/pm.max_children = 50/' $PHP_POOL
sed -i 's/pm.start_servers = .*/pm.start_servers = 5/' $PHP_POOL
sed -i 's/pm.min_spare_servers = .*/pm.min_spare_servers = 5/' $PHP_POOL
sed -i 's/pm.max_spare_servers = .*/pm.max_spare_servers = 35/' $PHP_POOL

# 4. PHP-FPM ì¬ì‹œì‘
systemctl restart php8.0-fpm
systemctl enable php8.0-fpm

echo "âœ… PHP ì„¤ì • ìµœì í™” ì™„ë£Œ!"
```

---

## 4. Node.js ì„¤ì¹˜ ë° ì„¤ì •

### ğŸŸ¢ Node.js 20.x ì„¤ì¹˜

```bash
#!/bin/bash
# install-nodejs.sh

echo "ğŸŸ¢ Node.js 20.x ì„¤ì¹˜ ì‹œì‘..."

# 1. NodeSource ì €ì¥ì†Œ ì¶”ê°€
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -

# 2. Node.js ì„¤ì¹˜
apt install -y nodejs

# 3. ë²„ì „ í™•ì¸
node --version
npm --version

# 4. npm ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸
npm install -g npm@latest

# 5. ìœ ìš©í•œ ì „ì—­ íŒ¨í‚¤ì§€ ì„¤ì¹˜
npm install -g \
    pm2 \
    typescript \
    ts-node \
    nodemon

echo "âœ… Node.js 20.x ì„¤ì¹˜ ì™„ë£Œ!"
```

### ğŸ“¦ í”„ë¡ íŠ¸ì—”ë“œ ì˜ì¡´ì„± ì„¤ì¹˜

```bash
#!/bin/bash
# install-frontend-deps.sh

echo "ğŸ“¦ í”„ë¡ íŠ¸ì—”ë“œ ì˜ì¡´ì„± ì„¤ì¹˜ ì¤‘..."

# 1. í”„ë¡ íŠ¸ì—”ë“œ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /var/www/topmkt/frontend/src/frontend

# 2. ì˜ì¡´ì„± ì„¤ì¹˜ (í”„ë¡œë•ì…˜ë§Œ)
npm ci --only=production

# 3. ë¹Œë“œ ë„êµ¬ ì„¤ì¹˜ (ê°œë°œ í™˜ê²½ì—ì„œë§Œ)
if [ "$NODE_ENV" != "production" ]; then
    npm ci
fi

# 4. ê¸€ë¡œë²Œ ë¹Œë“œ ë„êµ¬ í™•ì¸
npm list -g --depth=0

echo "âœ… í”„ë¡ íŠ¸ì—”ë“œ ì˜ì¡´ì„± ì„¤ì¹˜ ì™„ë£Œ!"
```

---

## 5. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì¹˜ ë° ì„¤ì •

### ğŸ—„ï¸ MariaDB 10.6 ì„¤ì¹˜

```bash
#!/bin/bash
# install-mariadb.sh

echo "ğŸ—„ï¸ MariaDB 10.6 ì„¤ì¹˜ ì‹œì‘..."

# 1. MariaDB ì €ì¥ì†Œ ì¶”ê°€
curl -LsS https://downloads.mariadb.com/MariaDB/mariadb_repo_setup | bash

# 2. MariaDB ì„¤ì¹˜
apt install -y mariadb-server mariadb-client

# 3. MariaDB ì„œë¹„ìŠ¤ ì‹œì‘
systemctl start mariadb
systemctl enable mariadb

# 4. ë³´ì•ˆ ì„¤ì •
mysql_secure_installation

echo "âœ… MariaDB 10.6 ì„¤ì¹˜ ì™„ë£Œ!"
```

### ğŸ”§ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

```bash
#!/bin/bash
# configure-database.sh

echo "ğŸ”§ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ì¤‘..."

# 1. MariaDB ìµœì í™” ì„¤ì •
cat > /etc/mysql/mariadb.conf.d/99-topmkt.cnf << 'EOF'
[mysqld]
# ê¸°ë³¸ ì„¤ì •
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci
init-connect = 'SET NAMES utf8mb4'

# ì„±ëŠ¥ ìµœì í™”
innodb_buffer_pool_size = 512M
innodb_log_file_size = 128M
innodb_flush_log_at_trx_commit = 2
query_cache_size = 64M
query_cache_type = 1
max_connections = 200
key_buffer_size = 256M

# ë¡œê¹…
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2

[mysql]
default-character-set = utf8mb4

[client]
default-character-set = utf8mb4
EOF

# 2. MariaDB ì¬ì‹œì‘
systemctl restart mariadb

echo "âœ… ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ì™„ë£Œ!"
```

### ğŸ—ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

```bash
#!/bin/bash
# init-database.sh

echo "ğŸ—ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ì¤‘..."

# 1. ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
mysql -u root -p << 'EOF'
CREATE DATABASE IF NOT EXISTS topmkt 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;

CREATE USER IF NOT EXISTS 'topmkt_user'@'localhost' 
IDENTIFIED BY 'secure_password_here';

GRANT ALL PRIVILEGES ON topmkt.* TO 'topmkt_user'@'localhost';
FLUSH PRIVILEGES;
EOF

# 2. í…Œì´ë¸” ìƒì„±
cd /var/www/topmkt
php create_tables.php

echo "âœ… ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ì™„ë£Œ!"
```

---

## 6. ì›¹ ì„œë²„ ì„¤ì •

### ğŸŒ Apache 2.4 ì„¤ì¹˜ ë° ì„¤ì •

```bash
#!/bin/bash
# install-apache.sh

echo "ğŸŒ Apache 2.4 ì„¤ì¹˜ ì‹œì‘..."

# 1. Apache ì„¤ì¹˜
apt install -y apache2

# 2. í•„ìˆ˜ ëª¨ë“ˆ í™œì„±í™”
a2enmod rewrite
a2enmod ssl
a2enmod headers
a2enmod expires
a2enmod deflate
a2enmod proxy
a2enmod proxy_fcgi

# 3. PHP-FPM ì—°ë™ ì„¤ì •
a2enconf php8.0-fpm

# 4. Apache ì„œë¹„ìŠ¤ ì‹œì‘
systemctl start apache2
systemctl enable apache2

echo "âœ… Apache 2.4 ì„¤ì¹˜ ì™„ë£Œ!"
```

### âš™ï¸ Virtual Host ì„¤ì •

```bash
#!/bin/bash
# configure-vhost.sh

echo "âš™ï¸ Virtual Host ì„¤ì • ì¤‘..."

# 1. ì‚¬ì´íŠ¸ ì„¤ì • íŒŒì¼ ìƒì„±
cat > /etc/apache2/sites-available/topmkt.conf << 'EOF'
<VirtualHost *:80>
    ServerName www.topmktx.com
    ServerAlias topmktx.com
    DocumentRoot /var/www/topmkt/public
    
    # ë””ë ‰í† ë¦¬ ì„¤ì •
    <Directory /var/www/topmkt/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # PHP-FPM ì²˜ë¦¬
        <FilesMatch \.php$>
            SetHandler "proxy:unix:/var/run/php/php8.0-fpm.sock|fcgi://localhost"
        </FilesMatch>
    </Directory>
    
    # ë¡œê·¸ ì„¤ì •
    ErrorLog ${APACHE_LOG_DIR}/topmkt_error.log
    CustomLog ${APACHE_LOG_DIR}/topmkt_access.log combined
    
    # ë³´ì•ˆ í—¤ë”
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    
    # HTTPì—ì„œ HTTPSë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    Redirect permanent / https://www.topmktx.com/
</VirtualHost>

<VirtualHost *:443>
    ServerName www.topmktx.com
    ServerAlias topmktx.com
    DocumentRoot /var/www/topmkt/public
    
    # SSL ì„¤ì • (Let's Encrypt ì„¤ì¹˜ í›„ ì¶”ê°€ë¨)
    SSLEngine on
    # SSLCertificateFile /etc/letsencrypt/live/www.topmktx.com/fullchain.pem
    # SSLCertificateKeyFile /etc/letsencrypt/live/www.topmktx.com/privkey.pem
    
    # ë””ë ‰í† ë¦¬ ì„¤ì •
    <Directory /var/www/topmkt/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # PHP-FPM ì²˜ë¦¬
        <FilesMatch \.php$>
            SetHandler "proxy:unix:/var/run/php/php8.0-fpm.sock|fcgi://localhost"
        </FilesMatch>
    </Directory>
    
    # ì •ì  íŒŒì¼ ìºì‹±
    <LocationMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg)$">
        ExpiresActive On
        ExpiresDefault "access plus 1 month"
        Header append Cache-Control "public"
    </LocationMatch>
    
    # ì••ì¶• ì„¤ì •
    <Location />
        SetOutputFilter DEFLATE
        SetEnvIfNoCase Request_URI \
            \.(?:gif|jpe?g|png)$ no-gzip dont-vary
        SetEnvIfNoCase Request_URI \
            \.(?:exe|t?gz|zip|bz2|sit|rar)$ no-gzip dont-vary
    </Location>
    
    # ë¡œê·¸ ì„¤ì •
    ErrorLog ${APACHE_LOG_DIR}/topmkt_ssl_error.log
    CustomLog ${APACHE_LOG_DIR}/topmkt_ssl_access.log combined
    
    # ë³´ì•ˆ í—¤ë”
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
</VirtualHost>
EOF

# 2. ì‚¬ì´íŠ¸ í™œì„±í™”
a2ensite topmkt.conf
a2dissite 000-default.conf

# 3. ì„¤ì • ê²€ì¦ ë° ì¬ì‹œì‘
apache2ctl configtest
systemctl restart apache2

echo "âœ… Virtual Host ì„¤ì • ì™„ë£Œ!"
```

---

## 7. í”„ë¡œì íŠ¸ ë°°í¬

### ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±

```bash
#!/bin/bash
# setup-directories.sh

echo "ğŸ“ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„± ì¤‘..."

# 1. ê¸°ë³¸ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p /var/www/topmkt
mkdir -p /var/www/topmkt/logs
mkdir -p /var/www/topmkt/backup
mkdir -p /var/cache/topmkt
mkdir -p /var/uploads/topmkt

# 2. ê¶Œí•œ ì„¤ì •
chown -R www-data:www-data /var/www/topmkt
chown -R www-data:www-data /var/cache/topmkt
chown -R www-data:www-data /var/uploads/topmkt

# 3. ê¶Œí•œ ì„¤ì •
chmod -R 755 /var/www/topmkt
chmod -R 775 /var/www/topmkt/logs
chmod -R 775 /var/cache/topmkt
chmod -R 775 /var/uploads/topmkt

echo "âœ… ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„± ì™„ë£Œ!"
```

### ğŸš€ ì½”ë“œ ë°°í¬

```bash
#!/bin/bash
# deploy-code.sh

echo "ğŸš€ ì½”ë“œ ë°°í¬ ì‹œì‘..."

PROJECT_DIR="/var/www/topmkt"
BACKUP_DIR="/var/www/topmkt/backup"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)

# 1. ê¸°ì¡´ ì½”ë“œ ë°±ì—… (ìˆëŠ” ê²½ìš°)
if [ -d "$PROJECT_DIR/public" ]; then
    echo "ğŸ“¦ ê¸°ì¡´ ì½”ë“œ ë°±ì—… ì¤‘..."
    tar -czf "$BACKUP_DIR/backup_$TIMESTAMP.tar.gz" -C "$PROJECT_DIR" . 2>/dev/null || true
fi

# 2. Gitì—ì„œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸° (ë˜ëŠ” íŒŒì¼ ë³µì‚¬)
# Option A: Git clone
# git clone https://github.com/your-repo/topmkt.git $PROJECT_DIR

# Option B: ì••ì¶• íŒŒì¼ í•´ì œ (ì—…ë¡œë“œëœ ê²½ìš°)
# cd $PROJECT_DIR && tar -xzf topmkt-source.tar.gz

# 3. ì˜ì¡´ì„± ì„¤ì¹˜
cd $PROJECT_DIR/frontend/src/frontend
npm ci --only=production

# 4. í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ
npm run build

# 5. ê¶Œí•œ ì¬ì„¤ì •
chown -R www-data:www-data $PROJECT_DIR
chmod -R 755 $PROJECT_DIR
chmod -R 775 $PROJECT_DIR/logs

# 6. ìºì‹œ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p /var/cache/topmkt
chown -R www-data:www-data /var/cache/topmkt

echo "âœ… ì½”ë“œ ë°°í¬ ì™„ë£Œ!"
```

---

## 8. SSL ì¸ì¦ì„œ ì„¤ì •

### ğŸ”’ Let's Encrypt ì„¤ì •

```bash
#!/bin/bash
# setup-ssl.sh

echo "ğŸ”’ SSL ì¸ì¦ì„œ ì„¤ì • ì‹œì‘..."

# 1. Certbot ì„¤ì¹˜ (ì´ë¯¸ ì„¤ì¹˜ë¨)
apt install -y python3-certbot-apache

# 2. SSL ì¸ì¦ì„œ ë°œê¸‰
certbot --apache -d www.topmktx.com -d topmktx.com

# 3. ìë™ ê°±ì‹  ì„¤ì •
echo "0 12 * * * /usr/bin/certbot renew --quiet" | crontab -

# 4. Apache ì¬ì‹œì‘
systemctl restart apache2

# 5. SSL ì„¤ì • í™•ì¸
echo "ğŸ” SSL ì„¤ì • í™•ì¸..."
curl -I https://www.topmktx.com | head -n 5

echo "âœ… SSL ì¸ì¦ì„œ ì„¤ì • ì™„ë£Œ!"
```

---

## 9. ë³´ì•ˆ ì„¤ì •

### ğŸ›¡ï¸ ë°©í™”ë²½ ì„¤ì •

```bash
#!/bin/bash
# setup-firewall.sh

echo "ğŸ›¡ï¸ ë°©í™”ë²½ ì„¤ì • ì¤‘..."

# 1. UFW ì´ˆê¸°í™”
ufw --force reset

# 2. ê¸°ë³¸ ì •ì±… ì„¤ì •
ufw default deny incoming
ufw default allow outgoing

# 3. SSH í—ˆìš© (í¬íŠ¸ ë³€ê²½ ê¶Œì¥)
ufw allow 22/tcp
# ufw allow 2222/tcp  # SSH í¬íŠ¸ ë³€ê²½ ì‹œ

# 4. HTTP/HTTPS í—ˆìš©
ufw allow 80/tcp
ufw allow 443/tcp

# 5. MySQL (ë¡œì»¬ë§Œ)
# ufw allow from 127.0.0.1 to any port 3306

# 6. UFW í™œì„±í™”
ufw --force enable

# 7. ìƒíƒœ í™•ì¸
ufw status verbose

echo "âœ… ë°©í™”ë²½ ì„¤ì • ì™„ë£Œ!"
```

### ğŸ” Fail2Ban ì„¤ì •

```bash
#!/bin/bash
# setup-fail2ban.sh

echo "ğŸ” Fail2Ban ì„¤ì • ì¤‘..."

# 1. SSH ë³´í˜¸ ì„¤ì •
cat > /etc/fail2ban/jail.local << 'EOF'
[DEFAULT]
bantime = 3600
findtime = 600
maxretry = 3

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3

[apache-auth]
enabled = true
port = http,https
filter = apache-auth
logpath = /var/log/apache2/*error.log
maxretry = 3

[apache-badbots]
enabled = true
port = http,https
filter = apache-badbots
logpath = /var/log/apache2/*access.log
maxretry = 3
EOF

# 2. Fail2Ban ì¬ì‹œì‘
systemctl restart fail2ban
systemctl enable fail2ban

# 3. ìƒíƒœ í™•ì¸
fail2ban-client status

echo "âœ… Fail2Ban ì„¤ì • ì™„ë£Œ!"
```

---

## 10. ëª¨ë‹ˆí„°ë§ ì„¤ì •

### ğŸ“Š ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì •

```bash
#!/bin/bash
# setup-logrotate.sh

echo "ğŸ“Š ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì • ì¤‘..."

# 1. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ë¡œí…Œì´ì…˜
cat > /etc/logrotate.d/topmkt << 'EOF'
/var/www/topmkt/logs/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 www-data www-data
    postrotate
        systemctl reload apache2
    endscript
}
EOF

# 2. MySQL ìŠ¬ë¡œìš° ì¿¼ë¦¬ ë¡œê·¸ ë¡œí…Œì´ì…˜
cat > /etc/logrotate.d/mysql-slow << 'EOF'
/var/log/mysql/slow.log {
    daily
    missingok
    rotate 7
    compress
    delaycompress
    notifempty
    create 644 mysql mysql
    postrotate
        systemctl reload mysql
    endscript
}
EOF

echo "âœ… ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì • ì™„ë£Œ!"
```

### ğŸ” ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸

```bash
#!/bin/bash
# system-monitor.sh

cat > /usr/local/bin/system-monitor.sh << 'EOF'
#!/bin/bash

# ì‹œìŠ¤í…œ ìƒíƒœ ì²´í¬ ìŠ¤í¬ë¦½íŠ¸
LOG_FILE="/var/log/system-monitor.log"
DATE=$(date '+%Y-%m-%d %H:%M:%S')

# 1. ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
check_service() {
    local service=$1
    if systemctl is-active --quiet $service; then
        echo "[$DATE] âœ… $service is running" >> $LOG_FILE
    else
        echo "[$DATE] âŒ $service is not running" >> $LOG_FILE
        systemctl restart $service
    fi
}

# 2. ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ í™•ì¸
DISK_USAGE=$(df / | tail -1 | awk '{print $5}' | sed 's/%//')
if [ $DISK_USAGE -gt 80 ]; then
    echo "[$DATE] âš ï¸ Disk usage is high: ${DISK_USAGE}%" >> $LOG_FILE
fi

# 3. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
MEM_USAGE=$(free | grep Mem | awk '{printf("%.0f", $3/$2 * 100.0)}')
if [ $MEM_USAGE -gt 85 ]; then
    echo "[$DATE] âš ï¸ Memory usage is high: ${MEM_USAGE}%" >> $LOG_FILE
fi

# 4. ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
check_service apache2
check_service mysql
check_service php8.0-fpm

# 5. ì›¹ì‚¬ì´íŠ¸ ì‘ë‹µ í™•ì¸
if ! curl -s --max-time 10 https://www.topmktx.com > /dev/null; then
    echo "[$DATE] âŒ Website is not responding" >> $LOG_FILE
fi
EOF

chmod +x /usr/local/bin/system-monitor.sh

# 3. í¬ë¡  ì‘ì—… ì„¤ì •
echo "*/5 * * * * /usr/local/bin/system-monitor.sh" | crontab -

echo "âœ… ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§ ì„¤ì • ì™„ë£Œ!"
```

---

## ğŸ¯ ì„¤ì¹˜ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… ì‹œìŠ¤í…œ ê¸°ë³¸ ì„¤ì •
- [ ] ìš´ì˜ì²´ì œ ì—…ë°ì´íŠ¸ ì™„ë£Œ
- [ ] í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ
- [ ] ì‚¬ìš©ì ë° ê¶Œí•œ ì„¤ì • ì™„ë£Œ
- [ ] ë°©í™”ë²½ ì„¤ì • ì™„ë£Œ

### âœ… ì†Œí”„íŠ¸ì›¨ì–´ ìŠ¤íƒ
- [ ] PHP 8.0 ì„¤ì¹˜ ë° ì„¤ì • ì™„ë£Œ
- [ ] Node.js 20.x ì„¤ì¹˜ ë° ì„¤ì • ì™„ë£Œ
- [ ] MariaDB 10.6 ì„¤ì¹˜ ë° ì„¤ì • ì™„ë£Œ
- [ ] Apache 2.4 ì„¤ì¹˜ ë° ì„¤ì • ì™„ë£Œ

### âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬
- [ ] í”„ë¡œì íŠ¸ ì½”ë“œ ë°°í¬ ì™„ë£Œ
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ì™„ë£Œ
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ ì™„ë£Œ
- [ ] Virtual Host ì„¤ì • ì™„ë£Œ

### âœ… ë³´ì•ˆ ë° SSL
- [ ] SSL ì¸ì¦ì„œ ì„¤ì¹˜ ì™„ë£Œ
- [ ] HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ ì„¤ì • ì™„ë£Œ
- [ ] Fail2Ban ì„¤ì • ì™„ë£Œ
- [ ] ë³´ì•ˆ í—¤ë” ì„¤ì • ì™„ë£Œ

### âœ… ëª¨ë‹ˆí„°ë§ ë° ë°±ì—…
- [ ] ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì • ì™„ë£Œ
- [ ] ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§ ì„¤ì • ì™„ë£Œ
- [ ] ìë™ ë°±ì—… ì„¤ì • ì™„ë£Œ
- [ ] ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ í™œì„±í™”

---

## ğŸš¨ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ì„¤ì¹˜ ë¬¸ì œ

#### 1. PHP í™•ì¥ ëª¨ë“ˆ ì˜¤ë¥˜
```bash
# í™•ì¥ ëª¨ë“ˆ ì¬ì„¤ì¹˜
apt install --reinstall php8.0-mysql php8.0-curl php8.0-gd php8.0-zip

# ëª¨ë“ˆ í™•ì¸
php -m | grep -E "(mysqli|curl|gd|zip)"
```

#### 2. Apache ê¶Œí•œ ë¬¸ì œ
```bash
# ê¶Œí•œ ì¬ì„¤ì •
chown -R www-data:www-data /var/www/topmkt
chmod -R 755 /var/www/topmkt
```

#### 3. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜
```bash
# MySQL ìƒíƒœ í™•ì¸
systemctl status mysql

# ì‚¬ìš©ì ê¶Œí•œ í™•ì¸
mysql -u root -p -e "SHOW GRANTS FOR 'topmkt_user'@'localhost';"
```

#### 4. SSL ì¸ì¦ì„œ ë¬¸ì œ
```bash
# Certbot ë¡œê·¸ í™•ì¸
cat /var/log/letsencrypt/letsencrypt.log

# ìˆ˜ë™ ê°±ì‹  ì‹œë„
certbot renew --dry-run
```

---

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

### ğŸ†˜ ê¸´ê¸‰ ì§€ì›
- **ê¸°ìˆ  ì§€ì›**: dev@topmktx.com
- **ì„œë²„ ì¥ì• **: 24ì‹œê°„ ëŒ€ê¸°
- **ë³´ì•ˆ ì´ìŠˆ**: security@topmktx.com

### ğŸ“š ê´€ë ¨ ë¬¸ì„œ
- [ë°°í¬ ë° ìš´ì˜ ê°€ì´ë“œ](14.ë°°í¬_ìš´ì˜_ê°€ì´ë“œ.md)
- [ë³´ì•ˆ ê°€ì´ë“œ](17.ë³´ì•ˆ_ê°€ì´ë“œ.md)
- [ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ](15.ì„±ëŠ¥_ìµœì í™”_ê°€ì´ë“œ.md)

---

*ğŸ“ ë¬¸ì„œ ì‘ì„±ì: ì‹œìŠ¤í…œ ê´€ë¦¬íŒ€*  
*ğŸ“§ ë¬¸ì˜: sysadmin@topmktx.com*  
*ğŸ”„ ì—…ë°ì´íŠ¸: ì£¼ìš” ì‹œìŠ¤í…œ ë³€ê²½ ì‹œ*